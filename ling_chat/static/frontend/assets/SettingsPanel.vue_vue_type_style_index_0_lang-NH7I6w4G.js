import{d as j,p as re,q as J,r as m,s as q,v as U,c as _,j as N,b as a,n as te,h as f,x as le,_ as F,o as Z,y as pe,F as O,m as X,t as C,i as W,e as G,z as $,k as l,A as se,B as Ce,C as _e,D as H,E as de,G as ke,f as d,H as we,I as he,J as $e,K as Se,L as ge,M as Y,w as h,N as ee,O as be,l as ve,P as ne}from"./index-CrIUDniy.js";import{S as Me,_ as Ae}from"./StarField-BsiWDnRc.js";const ye="/api/v1",L={AVATAR:{BASE:`${ye}/chat/character/get_avatar`},VOICE:{BASE:`${ye}/chat/sound/get_voice`}},Be={ÂéåÊÅ∂:"ÂéåÊÅ∂",È´òÂÖ¥:"È´òÂÖ¥",ÊãÖÂøÉ:"ÊãÖÂøÉ",ÁîüÊ∞î:"ÁîüÊ∞î",Á¥ßÂº†:"Á¥ßÂº†",ÂÆ≥ÊÄï:"ÂÆ≥ÊÄï",ÂÆ≥Áæû:"ÂÆ≥Áæû",ÊÖåÂº†:"ÊÖåÂº†",ËÆ§Áúü:"ËÆ§Áúü",Êó†Â•à:"Êó†Â•à",ÂÖ¥Â•ã:"ÂÖ¥Â•ã",ÁñëÊÉë:"ÁñëÊÉë",Âì≠Ê≥£:"‰º§ÂøÉ",ÂøÉÂä®:"ÂøÉÂä®",Ë∞ÉÁöÆ:"Ë∞ÉÁöÆ",Èöæ‰∏∫ÊÉÖ:"ÁæûËÄª",Ëá™‰ø°:"Ëá™‰ø°",ÊÉäËÆ∂:"ÊÉäËÆ∂",Ê≠£Â∏∏:"Ê≠£Â∏∏",AIÊÄùËÄÉ:"none"},fe={ÂéåÊÅ∂:{animation:"none",bubbleImage:"../pictures/animation/ÁîüÊ∞î.webp",bubbleClass:"angry",audio:"../audio_effects/ÂéåÊÅ∂.wav",avatar:`${L.AVATAR.BASE}/ÂéåÊÅ∂.png`},È´òÂÖ¥:{animation:"happy-bounce",bubbleImage:"../pictures/animation/È´òÂÖ¥.webp",bubbleClass:"happy",audio:"../audio_effects/ÂñúÊÇ¶.wav",avatar:`${L.AVATAR.BASE}/È´òÂÖ¥.png`},ÊãÖÂøÉ:{animation:"none",bubbleImage:"../pictures/animation/ÊµÅÊ≥™.webp",bubbleClass:"none",audio:"../audio_effects/‰º§ÂøÉ.wav",avatar:`${L.AVATAR.BASE}/ÊãÖÂøÉ.png`},ÁîüÊ∞î:{animation:"angry-jump",bubbleImage:"../pictures/animation/ÁîüÊ∞î2.webp",bubbleClass:"angry",audio:"../audio_effects/ÁîüÊ∞î.wav",avatar:`${L.AVATAR.BASE}/ÁîüÊ∞î.png`},Á¥ßÂº†:{animation:"none",bubbleImage:"../pictures/animation/Á¥ßÂº†.webp",bubbleClass:"none",audio:"../audio_effects/Â∞¥Â∞¨.wav",avatar:`${L.AVATAR.BASE}/Á¥ßÂº†.png`},ÂÆ≥ÊÄï:{animation:"none",bubbleImage:"../pictures/animation/ÊÉäËÆ∂.webp",bubbleClass:"none",audio:"../audio_effects/ÈúáÊÉä.wav",avatar:`${L.AVATAR.BASE}/ÂÆ≥ÊÄï.png`},ÂÆ≥Áæû:{animation:"none",bubbleImage:"../pictures/animation/ÂÆ≥Áæû.webp",bubbleClass:"shy",audio:"../audio_effects/ÂÆ≥Áæû.wav",avatar:`${L.AVATAR.BASE}/ÂÆ≥Áæû.png`},ÊÖåÂº†:{animation:"none",bubbleImage:"../pictures/animation/ÊÖå‰π±.webp",bubbleClass:"none",audio:"../audio_effects/ÈúáÊÉä.wav",avatar:`${L.AVATAR.BASE}/ÊÖåÂº†.png`},ËÆ§Áúü:{animation:"serious-think",bubbleImage:"none",bubbleClass:"none",audio:"none",avatar:`${L.AVATAR.BASE}/ËÆ§Áúü.png`},Êó†Â•à:{animation:"none",bubbleImage:"../pictures/animation/ÂèπÊ∞î.webp",bubbleClass:"none",audio:"../audio_effects/ÂèπÊ∞î.wav",avatar:`${L.AVATAR.BASE}/Êó†Â•à.png`},ÂÖ¥Â•ã:{animation:"happy-bounce",bubbleImage:"../pictures/animation/ËÅäÂ§©.webp",bubbleClass:"none",audio:"../audio_effects/ËÅäÂ§©.wav",avatar:`${L.AVATAR.BASE}/ÂÖ¥Â•ã.png`},ÁñëÊÉë:{animation:"none",bubbleImage:"../pictures/animation/ÁñëÈóÆ.webp",bubbleClass:"none",audio:"../audio_effects/ÁñëÈóÆ.wav",avatar:`${L.AVATAR.BASE}/ÁñëÊÉë.png`},Âì≠Ê≥£:{animation:"none",bubbleImage:"../pictures/animation/ÊµÅÊ≥™.webp",bubbleClass:"none",audio:"../audio_effects/‰º§ÂøÉ.wav",avatar:`${L.AVATAR.BASE}/‰º§ÂøÉ.png`},ÂøÉÂä®:{animation:"heart-beat",bubbleImage:"../pictures/animation/ÂøÉÂä®.webp",bubbleClass:"none",audio:"../audio_effects/ÂñúÁà±.wav",avatar:`${L.AVATAR.BASE}/ÂøÉÂä®.png`},Ë∞ÉÁöÆ:{animation:"naughty-bounce",bubbleImage:"../pictures/animation/È´òÂÖ¥.webp",bubbleClass:"none",audio:"../audio_effects/ÊÑâÂø´.wav",avatar:`${L.AVATAR.BASE}/Ë∞ÉÁöÆ.png`},Èöæ‰∏∫ÊÉÖ:{animation:"embarrassed-emo",bubbleImage:"../pictures/animation/Èöæ‰∏∫ÊÉÖ.webp",bubbleClass:"none",audio:"../audio_effects/ÂØüËßâ.wav",avatar:`${L.AVATAR.BASE}/ÁæûËÄª.png`},Ëá™‰ø°:{animation:"none",bubbleImage:"../pictures/animation/È´òÂÖ¥.webp",bubbleClass:"none",audio:"../audio_effects/ÊÑâÂø´.wav",avatar:`${L.AVATAR.BASE}/Ëá™‰ø°.png`},ÊÉäËÆ∂:{animation:"none",bubbleImage:"../pictures/animation/ÊÉäËÆ∂.webp",bubbleClass:"none",audio:"../audio_effects/ÂØüËßâ.wav",avatar:`${L.AVATAR.BASE}/ÊÉäËÆ∂.png`},Ê≠£Â∏∏:{animation:"none",bubbleImage:"none",bubbleClass:"none",audio:"none",avatar:`${L.AVATAR.BASE}/Ê≠£Â∏∏.png`},AIÊÄùËÄÉ:{animation:"none",bubbleImage:"../pictures/animation/AIÊÄùËÄÉ.webp",bubbleClass:"none",audio:"../audio_effects/Êó†ËØ≠.wav",avatar:"none"}},Ie=j({__name:"GameAvatar",emits:["audio-ended"],setup(n,{expose:e,emit:u}){const o=re(),t=J(),s=u,c=m(null),p=m(null),y=m("normalx"),k=m(""),x=m(!1),M=m(""),g=m(""),r=q(()=>{const w=o.character,B=o.avatar.emotion,Q=fe[B]||fe.Ê≠£Â∏∏;return B==="AIÊÄùËÄÉ"?"none":o.script.isRunning?`/api/v1/chat/character/get_script_avatar/${w}/${Be[B]}`:`${Q.avatar}`}),i=q(()=>({[y.value]:!0,"avatar-visible":o.avatar.show,"avatar-hidden":!o.avatar.show})),b=q(()=>({backgroundImage:`url(${k.value})`,top:`${o.avatar.offset_y}px`,transform:`scale(${o.avatar.scale})`})),S=q(()=>({show:x.value,[g.value]:x.value&&g.value})),T=q(()=>({left:`${o.avatar.bubble_left}%`,top:`${o.avatar.bubble_top}%`,backgroundImage:`url(${M.value})`})),z=w=>{if(!w||w==="none")return;const B=Date.now(),Q=`${w}?t=${B}`,V=new Image;V.onload=()=>{k.value=Q},V.onerror=()=>{console.error(`Âä†ËΩΩÂ§¥ÂÉèÂ§±Ë¥•: ${Q}`),k.value="/api/v1/chat/character/get_avatar/Ê≠£Â∏∏.png"},V.src=Q};U(r,w=>{z(w)},{immediate:!0}),U(()=>o.avatar.character_id,w=>{z(r.value)}),U(()=>o.avatar.emotion,w=>{const B=fe[w];if(B){if(B.animation&&B.animation!=="none"&&(y.value=B.animation),B.bubbleImage&&B.bubbleImage!=="none"){const Q=Date.now();M.value=`${B.bubbleImage}?t=${Q}#t=0.1`,g.value=B.bubbleClass,x.value=!1,le(()=>{x.value=!0}),setTimeout(()=>{x.value=!1},2e3)}B.audio&&B.audio!=="none"&&p.value&&(p.value.src=B.audio,p.value.load(),p.value.play())}},{immediate:!0}),U(()=>t.currentAvatarAudio,w=>{c.value&&w&&w!=="None"&&(c.value.src=`${L.VOICE.BASE}/${w}`,c.value.load(),c.value.play())}),U(()=>t.characterVolume,w=>{c.value&&(c.value.volume=w/100)}),U(()=>t.bubbleVolume,w=>{p.value&&(p.value.volume=w/100)});const D=()=>{s("audio-ended")},E=()=>{y.value!=="normal"&&(y.value="normal")};return e({setEmotion:w=>{o.avatar.emotion=w}}),(w,B)=>(f(),_("div",{class:N([i.value,"avatar-container character-animation normal"]),onAnimationend:E},[a("div",{style:te(b.value),class:"avatar-img",id:"qinling"},null,4),a("div",{class:N([S.value,"bubble"]),style:te(T.value)},null,6),a("audio",{ref_key:"avatarAudio",ref:c,onEnded:D},null,544),a("audio",{ref_key:"bubbleAudio",ref:p},null,512)],34))}}),Te={__name:"Rain",props:{enabled:{type:Boolean,default:!0},intensity:{type:Number,default:1,validator:n=>n>=0&&n<=2}},setup(n){const e=n,u=m(50),o=m(20),t=m([]),s=m(null),c=m(null),p=m(0),y=m(null);U(()=>e.intensity,g=>{u.value=Math.max(10,100-g*45)},{immediate:!0});const k=()=>{e.enabled&&(clearInterval(s.value),s.value=setInterval(()=>{const g={top:-100,left:`${~~(Math.random()*100)}%`,speed:10+Math.random()*10*e.intensity,size:30+Math.random()*40*e.intensity,opacity:.2+Math.random()*.5};t.value.push(g)},u.value))},x=()=>{e.enabled&&(clearInterval(c.value),c.value=setInterval(()=>{const g=t.value.filter(r=>r.top<p.value);g.forEach(r=>{r.top+=r.speed}),t.value=g},o.value))},M=()=>{y.value&&y.value.parentElement?p.value=y.value.parentElement.clientHeight:p.value=window.innerHeight};return Z(()=>{le(()=>{M(),e.enabled&&(k(),x())}),window.addEventListener("resize",M)}),pe(()=>{clearInterval(s.value),clearInterval(c.value),window.removeEventListener("resize",M)}),U(()=>e.enabled,g=>{g?(M(),k(),x()):(clearInterval(s.value),clearInterval(c.value),t.value=[])}),(g,r)=>(f(),_("div",{class:"rain-container",ref_key:"containerRef",ref:y},[(f(!0),_(O,null,X(t.value,(i,b)=>(f(),_("span",{class:"rain-item",key:b,style:te({top:`${i.top}px`,left:i.left,height:`${i.size}px`,opacity:i.opacity})},null,4))),128))],512))}},Ee=F(Te,[["__scopeId","data-v-76d838e4"]]),Re=j({__name:"Sakura",props:{enabled:{type:Boolean,default:!0},intensity:{default:1}},setup(n){const e=n,u=m([]),o=m(null),t=m(0),s=m(Math.floor(25*e.intensity)),c=()=>Math.random().toString(36).substr(2,9),p=()=>{const r=Math.random()*10+10,i=Math.random()*window.innerWidth,b=-30,S=Math.random()*10+15,T=Math.random()*10,z=Math.random()*.5+.4,D=Math.random()*10+320,E=Math.random()*100-50;return{id:c(),size:r,left:i,top:b,opacity:z,hue:D,duration:S,delay:T,horizontalMovement:E}},y=r=>{const i=document.createElement("style");document.head.appendChild(i);const b=`
  @keyframes fall-${r.id} {
    0% {
      transform: translate(0, 0) rotate(0deg);
      opacity: ${r.opacity};
    }
    25% {
      transform: translate(${r.horizontalMovement*.25}px, ${t.value*.25}px) 
                 rotate(${90+Math.random()*90}deg);
      opacity: ${r.opacity*.9};
    }
    50% {
      transform: translate(${r.horizontalMovement*.5}px, ${t.value*.5}px) 
                 rotate(${180+Math.random()*90}deg);
      opacity: ${r.opacity*.7};
    }
    75% {
      transform: translate(${r.horizontalMovement*.75}px, ${t.value*.75}px) 
                 rotate(${270+Math.random()*90}deg);
      opacity: ${r.opacity*.5};
    }
    100% {
      transform: translate(${r.horizontalMovement}px, ${t.value}px) 
                 rotate(${360+Math.random()*180}deg);
      opacity: 0;
    }
  }
`;i.innerHTML=b,r.styleSheet=i},k=r=>{for(let i=0;i<r;i++){const b=p();y(b),u.value.push(b)}},x=()=>{u.value.forEach(r=>{r.styleSheet&&r.styleSheet.parentNode&&r.styleSheet.parentNode.removeChild(r.styleSheet)}),u.value=[]},M=()=>{o.value&&o.value.parentElement?t.value=o.value.parentElement.clientHeight:t.value=window.innerHeight},g=()=>{x(),k(s.value)};return U(()=>e.intensity,r=>{s.value=Math.floor(25*r),g()}),U(()=>e.enabled,r=>{r?(M(),k(s.value)):x()}),Z(()=>{le(()=>{M(),e.enabled&&k(s.value)}),window.addEventListener("resize",()=>{M(),g()})}),pe(()=>{x(),window.removeEventListener("resize",M)}),(r,i)=>(f(),_("div",{class:"petal-container",ref_key:"containerRef",ref:o},[(f(!0),_(O,null,X(u.value,(b,S)=>(f(),_("div",{class:"petal",key:S,style:te({width:`${b.size}px`,height:`${b.size}px`,left:`${b.left}px`,top:`${b.top}px`,opacity:b.opacity,background:`linear-gradient(135deg, hsl(${b.hue}, 100%, 85%), hsl(${b.hue}, 100%, 75%))`,animation:`fall-${b.id} ${b.duration}s linear ${b.delay}s infinite`})},null,4))),128))],512))}}),ze=F(Re,[["__scopeId","data-v-08072ab2"]]),Ve=j({__name:"Snow",props:{enabled:{type:Boolean,default:!0},intensity:{default:1}},setup(n){const e=n,u=m([]),o=m(null),t=m(0),s=m(Math.floor(50*e.intensity)),c=["‚ùÑ","‚ùÖ","‚ùÜ","‚Ä¢","¬∑"],p=()=>Math.random().toString(36).substr(2,9),y=()=>{const i=Math.random()*10+8,b=Math.random()*window.innerWidth,S=-30,T=Math.random()*15+20,z=Math.random()*10,D=Math.random()*.7+.3,E=Math.random()*100-50,A=c[Math.floor(Math.random()*c.length)];return{id:p(),size:i,left:b,top:S,opacity:D,duration:T,delay:z,horizontalMovement:E,content:A}},k=i=>{const b=document.createElement("style");document.head.appendChild(b);const S=`
  @keyframes fall-${i.id} {
    0% {
      transform: translate(0, 0) rotate(0deg);
      opacity: ${i.opacity};
    }
    25% {
      transform: translate(${i.horizontalMovement*.25}px, ${t.value*.25}px) 
                 rotate(${Math.random()*90}deg);
      opacity: ${i.opacity*.95};
    }
    50% {
      transform: translate(${i.horizontalMovement*.5}px, ${t.value*.5}px) 
                 rotate(${Math.random()*180}deg);
      opacity: ${i.opacity*.9};
    }
    75% {
      transform: translate(${i.horizontalMovement*.75}px, ${t.value*.75}px) 
                 rotate(${Math.random()*270}deg);
      opacity: ${i.opacity*.8};
    }
    100% {
      transform: translate(${i.horizontalMovement}px, ${t.value}px) 
                 rotate(${Math.random()*360}deg);
      opacity: ${i.opacity*.4};;
    }
  }
`;b.innerHTML=S,i.styleSheet=b},x=i=>{for(let b=0;b<i;b++){const S=y();k(S),u.value.push(S)}},M=()=>{u.value.forEach(i=>{i.styleSheet&&i.styleSheet.parentNode&&i.styleSheet.parentNode.removeChild(i.styleSheet)}),u.value=[]},g=()=>{o.value&&o.value.parentElement?t.value=o.value.parentElement.clientHeight:t.value=window.innerHeight},r=()=>{M(),x(s.value)};return U(()=>e.intensity,i=>{s.value=Math.floor(50*i),r()}),U(()=>e.enabled,i=>{i?(g(),x(s.value)):M()}),Z(()=>{le(()=>{g(),e.enabled&&x(s.value)}),window.addEventListener("resize",()=>{g(),r()})}),pe(()=>{M(),window.removeEventListener("resize",g)}),(i,b)=>(f(),_("div",{class:"snow-container",ref_key:"containerRef",ref:o},[(f(!0),_(O,null,X(u.value,(S,T)=>(f(),_("div",{class:"snowflake",key:T,style:te({width:`${S.size}px`,height:`${S.size}px`,left:`${S.left}px`,top:`${S.top}px`,opacity:S.opacity,animation:`fall-${S.id} ${S.duration}s linear ${S.delay}s infinite`})},C(S.content),5))),128))],512))}}),De=F(Ve,[["__scopeId","data-v-434a360c"]]),Ue={__name:"GameBackground",setup(n){const e=J(),u=m(null),o=m(),t=m(),s=m(!0),c=m(200),p=m(.4),y=m(["rgb(173, 216, 230)","rgb(176, 224, 230)","rgb(241, 141, 252)","rgb(176, 230, 224)","rgb(173, 230, 216)"]),k=m(!0),x=m(1),M=m(1.5),g=q(()=>({backgroundImage:e.currentBackground?`url(${e.currentBackground})`:"url(@/assets/images/default_bg.jpg)"})),r=i=>{console.debug("Starfield ready",i)};return U(()=>e.currentSoundEffect,i=>{o.value&&i&&i!=="None"&&(o.value.src=i,o.value.load(),o.value.play())}),U(()=>e.currentBackgroundMusic,i=>{t.value&&i&&i!=="None"&&(t.value.src=i,t.value.load(),t.value.play())}),(i,b)=>(f(),_(O,null,[a("div",{class:"game-background",style:te(g.value)},[l(e).currentBackgroundEffect==="StarField"?(f(),W(Me,{key:0,ref_key:"starfieldRef",ref:u,enabled:s.value,"star-count":c.value,"scroll-speed":p.value,colors:y.value,onReady:r},null,8,["enabled","star-count","scroll-speed","colors"])):G("",!0),l(e).currentBackgroundEffect==="Rain"?(f(),W(Ee,{key:1,enabled:k.value,intensity:x.value},null,8,["enabled","intensity"])):G("",!0),l(e).currentBackgroundEffect==="Sakura"?(f(),W(ze,{key:2,enabled:!0,intensity:1.5})):G("",!0),l(e).currentBackgroundEffect==="Snow"?(f(),W(De,{key:3,intensity:M.value,enabled:!0},null,8,["intensity"])):G("",!0),b[0]||(b[0]=$(" < ",-1))],4),a("audio",{ref_key:"soundEffectPlayer",ref:o},null,512),a("audio",{ref_key:"backgroundMusicPlayer",ref:t,loop:""},null,512)],64))}},Pe=F(Ue,[["__scopeId","data-v-701226d3"]]),je=["innerHTML"],Fe=j({__name:"Icon",props:{icon:{type:String,default:"none"},size:{type:Number,default:18}},emits:["click"],setup(n,{emit:e}){const u=n,o=q(()=>t[u.icon]),t={none:"",character:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 20a6 6 0 0 0-12 0"/><circle cx="12" cy="10" r="4"/><circle cx="12" cy="12" r="10"/></svg>',text:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"/><line x1="21" y1="6" x2="3" y2="6"/><line x1="21" y1="14" x2="3" y2="14"/><line x1="21" y1="18" x2="3" y2="18"/></svg>',background:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>',sound:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 10v3M6 7v9M10 4v15M14 7v9M18 10v3"/></svg>',history:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-history-icon lucide-history"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>',box:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="5" x="2" y="4" rx="2"/><path d="M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9"/><path d="M10 13h4"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play-icon lucide-play"><path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-marked-icon lucide-book-marked"><path d="M10 2v8l3-3 3 3V2"/><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20"/></svg>',advance:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="4" y1="21" y2="14" /><line x1="4" x2="4" y1="10" y2="3" /><line x1="12" x2="12" y1="21" y2="12" /><line x1="12" x2="12" y1="8" y2="3" /><line x1="20" x2="20" y1="21" y2="16" /><line x1="20"x2="20" y1="12" y2="3" /><line x1="2" x2="6" y1="14" y2="14" /><line x1="10" x2="14" y1="8" y2="8" /><line x1="18" x2="22" y1="16" y2="16" /></svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',schedule:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-list-icon lucide-clipboard-list"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M12 11h4"/><path d="M12 16h4"/><path d="M8 11h.01"/><path d="M8 16h.01"/></svg>',update:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-rss-icon lucide-rss"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume2-icon lucide-volume-2"><path d="M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"/><path d="M16 9a5 5 0 0 1 0 6"/><path d="M19.364 18.364a9 9 0 0 0 0-12.728"/></svg>'};return(s,c)=>(f(),_("span",{innerHTML:o.value,style:te(`width:${n.size}px, height:${n.size}px`),onClick:c[0]||(c[0]=p=>s.$emit("click"))},null,12,je))}}),me=F(Fe,[["__scopeId","data-v-c78ae12e"]]),Le=["disabled"],Oe=j({__name:"Button",props:{type:{},disabled:{type:Boolean},icon:{},icon_size:{}},emits:["click"],setup(n,{emit:e}){return(u,o)=>(f(),_("button",{class:N(n.type),disabled:n.disabled,onClick:o[0]||(o[0]=t=>u.$emit("click"))},[n.icon?(f(),W(me,{key:0,icon:n.icon,size:n.icon_size},null,8,["icon","size"])):G("",!0),se(u.$slots,"default",{},void 0,!0)],10,Le))}}),R=F(Oe,[["__scopeId","data-v-38c1a6cd"]]),He={name:"GlassInput",inheritAttrs:!1,props:{modelValue:{type:String,default:""}},emits:["update:modelValue"]},Ne={class:"form-group"},Ge=["value"];function We(n,e,u,o,t,s){return f(),_("div",Ne,[a("input",Ce({type:"text",class:"form-control",value:u.modelValue,onInput:e[0]||(e[0]=c=>n.$emit("update:modelValue",c.target.value))},n.$attrs),null,16,Ge)])}const qe=F(He,[["render",We],["__scopeId","data-v-ea73f387"]]),Ke=["min","max","step","value"],Je=j({__name:"Slider",props:{value:{type:Number,require:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1}},emits:["change","input"],setup(n,{emit:e}){const u=n,o=m(),t=_e();o.value=(u.min+u.max)/2;const s=q(()=>{if(t.default){const p=t.default();if(p&&p[0]&&typeof p[0].children=="string")return p[0].children.split("/")[0]||""}return""}),c=q(()=>{if(t.default){const p=t.default();if(p&&p[0]&&typeof p[0].children=="string")return p[0].children.split("/")[1]||""}return""});return(p,y)=>(f(),_("div",null,[a("span",null,[se(p.$slots,"left",{},()=>[$(C(s.value),1)],!0)]),H(a("input",{type:"range",min:n.min,max:n.max,step:n.step,value:o.value,onInput:y[0]||(y[0]=k=>p.$emit("input",Number(o.value))),onChange:y[1]||(y[1]=k=>p.$emit("change",Number(o.value))),"onUpdate:modelValue":y[2]||(y[2]=k=>o.value=k)},null,40,Ke),[[de,o.value]]),a("span",null,[se(p.$slots,"right",{},()=>[$(C(c.value),1)],!0)])]))}}),ce=F(Je,[["__scopeId","data-v-c3230732"]]),Qe={__name:"Text",props:{speed:{type:Number,default:0}},setup(n){const e=n,u=m(),o=_e().default()[0].children;U(()=>e.speed,()=>s(e.speed));let t;const s=c=>{clearInterval(t),u.value="";let p=0;const y=200,x=y-(c-1)/99*(y-10);t=setInterval(()=>{p<o.length?(u.value+=o.charAt(p),p++):clearInterval(t)},x)};return(c,p)=>(f(),_("div",null,[a("p",null,C(u.value),1),p[0]||(p[0]=a("span",null,null,-1))]))}},Ye=F(Qe,[["__scopeId","data-v-79a954ed"]]),Xe=["id","checked"],Ze=["for"],et=j({__name:"Toggle",props:{checked:{type:Boolean,default:!1}},emits:["change"],setup(n,{emit:e}){const u=m(),o=m();return Z(()=>{u.value=Math.random().toString(36).substring(2,9)}),(t,s)=>(f(),_("div",null,[H(a("input",{type:"checkbox",id:u.value,checked:n.checked,onChange:s[0]||(s[0]=c=>t.$emit("change",o.value)),"onUpdate:modelValue":s[1]||(s[1]=c=>o.value=c)},null,40,Xe),[[ke,o.value]]),a("label",{for:u.value},[se(t.$slots,"default",{},void 0,!0)],8,Ze)]))}}),ie=F(et,[["__scopeId","data-v-2c12f9f5"]]);class tt{element;timer=null;abortController;speed;isFinished;onFinishCallback;audioContext;soundBuffers;textBuffers;soundUrls;constructor(e){this.element=e,this.timer=null,this.abortController=null,this.speed=50,this.isFinished=!1,this.onFinishCallback=null,this.audioContext=null,this.soundBuffers=[],this.textBuffers="",this.soundUrls=["../audio_effects/ÂØπËØù.wav"]}async initAudio(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),await this.loadSounds()}catch(e){console.warn("Èü≥È¢ëÂàùÂßãÂåñÂ§±Ë¥•:",e);const u=J();u.enableChatEffectSound=!1}}async loadSounds(){if(this.audioContext)try{const e=this.soundUrls.map(async u=>{const t=await(await fetch(u)).arrayBuffer();return this.audioContext.decodeAudioData(t)});this.soundBuffers=await Promise.all(e)}catch(e){console.warn("Èü≥ÊïàÂä†ËΩΩÂ§±Ë¥•:",e)}}playRandomSound(){if(!J().enableChatEffectSound||!this.audioContext||this.soundBuffers.length===0)return;const u=this.soundBuffers[Math.floor(Math.random()*this.soundBuffers.length)],o=this.audioContext.createBufferSource();o.buffer=u,o.playbackRate.value=1;const t=this.audioContext.createGain();t.gain.value=.8,o.connect(t),t.connect(this.audioContext.destination),o.start()}setSoundEnabled(e){const u=J();u.enableChatEffectSound=e,e&&!this.audioContext&&this.initAudio()}async start(e,u){const o=J();this.stop(),this.isFinished=!1,u!==void 0?this.speed=Number.isInteger(u)?u:Number.parseInt(u.toString(),10)||50:(console.warn("ÈÄüÂ∫¶ÂÄºÊú™ÂÆö‰πâÔºåÂ∞ÜÈááÁî®ÈªòËÆ§ÈÄüÂ∫¶„ÄÇ"),this.speed=50),this.abortController=new AbortController;let t=0;this.textBuffers="",o.enableChatEffectSound&&!this.audioContext&&await this.initAudio();const s=()=>{if(!this.abortController?.signal.aborted)if(t<e.length){this.textBuffers+=e.charAt(t),this.element.value=this.textBuffers,this.element.textContent=this.textBuffers,this.playRandomSound(),t++,this.element.scrollTop=this.element.scrollHeight;const c=this.speed*.8,p=this.speed*.4,y=c+Math.random()*p;this.timer=setTimeout(s,y)}else this.finish()};s()}finish(){this.stop(),this.isFinished=!0,this.element.style.borderRight="none",this.onFinishCallback&&this.onFinishCallback()}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.abortController&&(this.abortController.abort(),this.abortController=null),this.isFinished=!1}clear(){this.element.value="",this.element.textContent="",this.textBuffers=""}checkFinished(){return this.isFinished}onFinish(e){this.onFinishCallback=e}}function at(n){const e=m(null),u=m(!1),o=()=>{n.value&&(e.value=new tt(n.value))},t=async(c,p)=>{e.value||o(),u.value=!0,await e.value?.start(c,p),u.value=!1},s=()=>{e.value?.stop(),e.value?.clear(),u.value=!1};return pe(()=>{s()}),{startTyping:t,stopTyping:s,isTyping:u}}const nt={class:"chatbox-box"},st={class:"chatbox-main"},ot={class:"chatbox-title-part"},lt={class:"chatbox-title"},rt={id:"character"},it={class:"chatbox-subtitle"},ut={id:"character-sub"},ct={class:"chatbox-emotion"},dt={id:"character-emotion"},pt={class:"chatbox-inputbox"},vt=["placeholder","onKeydown","readonly"],ft=["disabled"],ht=j({__name:"GameDialog",emits:["player-continued","dialog-proceed"],setup(n,{expose:e,emit:u}){const o=m(""),t=m(null),s=re(),c=J(),{startTyping:p,stopTyping:y}=at(t),k=q(()=>s.currentStatus==="thinking"),x=u,M=()=>{c.toggleSettings(!0),c.setSettingsTab("history")},g=q(()=>{switch(s.currentStatus){case"input":return c.showPlayerHintLine||"Âú®ËøôÈáåËæìÂÖ•Ê∂àÊÅØ...";case"thinking":return s.avatar.think_message;case"responding":case"presenting":return"";default:return"Âú®ËøôÈáåËæìÂÖ•Ê∂àÊÅØ..."}}),r=q(()=>s.currentStatus==="input");U(()=>s.currentStatus,T=>{console.log("Ê∏∏ÊàèÁä∂ÊÄÅÂèò‰∏∫ :",T),T==="thinking"?(s.avatar.emotion="AIÊÄùËÄÉ",c.showCharacterTitle=s.avatar.character_name,c.showCharacterSubtitle=s.avatar.character_subtitle):T==="input"?(c.showCharacterTitle=s.avatar.user_name,c.showCharacterSubtitle=s.avatar.user_subtitle,c.showCharacterEmotion=""):T==="presenting"&&(c.showCharacterTitle="",c.showCharacterSubtitle="",c.showCharacterEmotion="",c.showCharacterLine="")}),U([()=>c.showCharacterLine,()=>s.currentStatus],([T,z])=>{T&&T!==""&&z==="responding"?(o.value="",p(T,c.typeWriterSpeed)):z==="input"&&(y(),o.value="")});function i(){s.currentStatus==="input"?b():s.currentStatus==="responding"&&S(!0)}function b(){const T=o.value;T.trim()&&(T==="/ÂºÄÂßãÂâßÊú¨"?(s.initializeScript("TODO: ‰ªéÂâßÊú¨Èù¢ÊùøÈÄâÊã©ÂâßÊú¨"),s.avatar.show=!1,s.script.isRunning=!0):(s.currentStatus="thinking",s.addToDialogHistory({type:"message",character:s.avatar.user_name,content:T})),$e.sendMessage(T),o.value="")}function S(T){const z=Se.continue();return z||(T&&x("player-continued"),x("dialog-proceed")),z}return e({continueDialog:S}),(T,z)=>(f(),_("div",nt,[a("div",st,[a("div",ot,[a("div",lt,[a("div",rt,C(l(c).showCharacterTitle),1)]),a("div",it,[a("div",ut,C(l(c).showCharacterSubtitle),1)]),a("div",ct,[a("div",dt,C(l(c).showCharacterEmotion),1)]),d(l(R),{type:"nav",icon:"history",title:"",onClick:M})]),z[1]||(z[1]=a("div",{class:"chatbox-line"},null,-1)),a("div",pt,[H(a("textarea",{id:"inputMessage",ref_key:"textareaRef",ref:t,placeholder:g.value,"onUpdate:modelValue":z[0]||(z[0]=D=>o.value=D),onKeydown:we(he(i,["exact","prevent"]),["enter"]),readonly:!r.value},null,40,vt),[[de,o.value]]),a("button",{id:"sendButton",disabled:k.value,onClick:i}," ‚ñº ",8,ft)])])]))}}),gt={class:"main-box"},mt={id:"menu-panel"},Yn=j({__name:"MainChat",setup(n){const e=J(),u=re(),o=ge(),t=m(null),s=m(null),c=()=>{e.toggleSettings(!0),e.setSettingsTab("text")},p=()=>{e.autoMode=!e.autoMode},y=async()=>{try{await u.initializeGame(o.client_id,"1"),t.value?t.value.setEmotion("Ê≠£Â∏∏"):console.log("Ëøô‰∏™ÁªÑ‰ª∂‰∏çÂ≠òÂú®")}catch(b){console.log(b)}};Z(()=>{o.client_id!==""&&y()}),U(()=>u.avatar.character_id,(i,b)=>{i&&i!==b&&(console.log(`Character ID changed to ${i}, re-initializing...`),y())}),U(()=>o.client_id,i=>{i&&y()});let k=null;const x=m(!1),M=()=>{x.value=!1,k&&(clearTimeout(k),k=null)},g=()=>{if(e.autoMode){if(x.value){console.log("Áà∂ÁªÑ‰ª∂ÔºöÈü≥È¢ëÁªìÊùü‰∫ÜÔºå‰ΩÜÁî®Êà∑Â∑≤ÊâãÂä®ÁªßÁª≠Ôºå‰∏çÂÅö‰ªª‰Ωï‰∫ã„ÄÇ");return}u.currentStatus==="responding"&&(k&&clearTimeout(k),k=setTimeout(()=>{s.value?s.value.continueDialog(!1)&&g():console.error("Êó†Ê≥ïÊâæÂà∞ GameDialog ÁöÑÂÆû‰æã„ÄÇ")},1e3))}},r=()=>{console.log("Áî®Êà∑‰∏ªÂä®ÁÇπÂáª‰∫Ü"),k&&(clearTimeout(k),k=null,console.log("Áà∂ÁªÑ‰ª∂ÔºöÂ∑≤ÂèñÊ∂àËá™Âä®ÁªßÁª≠ÁöÑÂÆöÊó∂Âô®„ÄÇ")),x.value?console.log("Áà∂ÁªÑ‰ª∂ÔºöÁî®Êà∑ÈáçÂ§çÁÇπÂáªÔºå‰ΩÜÊñπÊ≥ïÂ∑≤ÊâßË°åËøáÔºå‰∏çÂÜçË∞ÉÁî®„ÄÇ"):x.value=!0};return(i,b)=>(f(),_("div",gt,[d(l(Pe)),d(l(Ie),{ref_key:"gameAvatarRef",ref:t,onAudioEnded:g},null,512),d(l(ht),{ref_key:"gameDialogRef",ref:s,onPlayerContinued:r,onDialogProceed:M},null,512),a("div",mt,[H(d(l(R),{type:"nav",icon:"play",onClick:p,class:N([{active:l(e).autoMode}])},{default:h(()=>[...b[0]||(b[0]=[a("h3",null,"Ëá™Âä®",-1)])]),_:1},8,["class"]),[[Y,l(e).showSettings!==!0]]),H(d(l(R),{type:"nav",icon:"text",onClick:c},{default:h(()=>[...b[1]||(b[1]=[a("h3",null,"ËèúÂçï",-1)])]),_:1},512),[[Y,l(e).showSettings!==!0]])])]))}}),bt=j({__name:"MenuItem",props:{title:{type:String,default:"ÈªòËÆ§Ê†áÈ¢ò"},size:{type:String,default:"large",validator:n=>["small","large"].includes(n)}},setup(n){return(e,u)=>(f(),_("section",{class:N(["menu-item",n.size])},[a("div",null,[a("h4",null,C(n.title),1)]),se(e.$slots,"default",{},void 0,!0)],2))}}),P=F(bt,[["__scopeId","data-v-1e6741a6"]]),yt={},_t={class:"flex flex-1 px-3 py-6 text-white text-shadow-2xs mx-auto items-start w-[70%] h-fit max-h-full flex-wrap gap-5"};function kt(n,e){return f(),_("div",_t,[se(n.$slots,"default")])}const ae=F(yt,[["render",kt]]),wt=async n=>{try{return await ee.get("/v1/chat/history/list",{params:n})}catch(e){throw new Error(e.response?.data?.message||"Ëé∑ÂèñÂ≠òÊ°£ÂàóË°®Â§±Ë¥•")}},xt=async n=>{try{await ee.post("/v1/chat/history/create",n)}catch(e){throw new Error(e.response?.data?.detail||"Â≠òÊ°£ÂàõÂª∫Â§±Ë¥•")}},Ct=async n=>{try{return await ee.get("/v1/chat/history/load",{params:n})}catch(e){throw new Error(e.response?.data?.detail||"Â≠òÊ°£Âä†ËΩΩÂ§±Ë¥•")}},$t=async n=>{try{await ee.post("/v1/chat/history/save",n)}catch(e){throw new Error(e.response?.data?.detail||"Â≠òÊ°£‰øùÂ≠òÂ§±Ë¥•")}},St=async n=>{try{await ee.post("/v1/chat/history/delete",n)}catch(e){throw new Error(e.response?.data?.detail||"Â≠òÊ°£Âà†Èô§Â§±Ë¥•")}},Mt={class:"new-save-form"},At={class:"save-section"},Bt={class:"save-list-container"},It={key:0,class:"status-message"},Tt={key:1,class:"status-message error"},Et={key:2,class:"status-message"},Rt={key:3,class:"save-list"},zt={class:"save-info"},Vt={class:"save-title"},Dt={class:"save-date"},Ut={class:"save-actions"},Pt=["onClick"],jt=["onClick"],Ft=["onClick"],oe="1",Lt=j({__name:"SettingsSave",setup(n){const e=re(),u=ge(),o=m([]),t=m(""),s=m(!1),c=m(null),p=r=>{const i=new Date(r);return`${i.getFullYear()}.${i.getMonth()+1}.${i.getDate()}`},y=async()=>{s.value=!0,c.value=null;try{const r=await wt({user_id:oe,page:1,page_size:10});o.value=r.conversations}catch(r){console.error("Ëé∑ÂèñÂ≠òÊ°£ÂàóË°®Â§±Ë¥•:",r),c.value=r.message||"Êú™Áü•ÈîôËØØ"}finally{s.value=!1}},k=async()=>{if(!t.value.trim()){alert("ËØ∑ËæìÂÖ•Â≠òÊ°£ÂêçÁß∞ÔºÅ");return}try{await xt({user_id:oe,title:t.value.trim()}),t.value="",await y()}catch(r){console.error("ÂàõÂª∫Â≠òÊ°£Â§±Ë¥•:",r),alert(`ÂàõÂª∫Â§±Ë¥•: ${r.message}`)}},x=async r=>{try{const i=await Ct({user_id:oe,conversation_id:r});alert(`Â≠òÊ°£ [${r}] ËØªÂèñÊàêÂäü!`),e.initializeGame(u.client_id,oe)}catch(i){console.error("ËØªÂèñÂ≠òÊ°£Â§±Ë¥•:",i),alert(`ËØªÂèñÂ§±Ë¥•: ${i.message}`)}},M=async r=>{try{await $t({user_id:oe,conversation_id:r}),alert(`ÊàêÂäüË¶ÜÁõñÂ≠òÊ°£ [${r}]!`),await y()}catch(i){console.error("‰øùÂ≠òÊ∏∏ÊàèÂ§±Ë¥•:",i),alert(`‰øùÂ≠òÂ§±Ë¥•: ${i.message}`)}},g=async r=>{if(confirm("Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Â≠òÊ°£ÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄ„ÄÇ"))try{await St({user_id:oe,conversation_id:r}),await y()}catch(i){console.error("Âà†Èô§Â≠òÊ°£Â§±Ë¥•:",i),alert(`Âà†Èô§Â§±Ë¥•: ${i.message}`)}};return Z(()=>{y()}),(r,i)=>(f(),W(l(ae),null,{default:h(()=>[d(l(P),{title:"ÂàõÂª∫Êñ∞Â≠òÊ°£"},{default:h(()=>[a("div",Mt,[d(l(qe),{type:"text",modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=b=>t.value=b),placeholder:"ËæìÂÖ•Â≠òÊ°£ÂêçÁß∞",onKeyup:we(k,["enter"])},null,8,["modelValue"]),a("button",{class:"glass-effect action-btn-create",onClick:k}," ÂàõÂª∫ ")])]),_:1}),d(l(P),{title:"Â≠òÊ°£ÂàóË°®"},{default:h(()=>[a("div",At,[a("div",Bt,[s.value?(f(),_("div",It,"Âä†ËΩΩ‰∏≠...")):c.value?(f(),_("div",Tt," Âä†ËΩΩÂ§±Ë¥•: "+C(c.value),1)):o.value.length===0?(f(),_("div",Et," ÊöÇÊó†Â≠òÊ°£ËÆ∞ÂΩï ")):(f(),_("div",Rt,[(f(!0),_(O,null,X(o.value,b=>(f(),_("div",{key:b.id,class:"save-card glass-effect"},[a("div",zt,[a("span",Vt,C(b.title||"Êú™ÂëΩÂêçÂ≠òÊ°£"),1),a("span",Dt,C(p(b.updated_at)),1)]),a("div",Ut,[a("button",{onClick:S=>x(b.id),class:"glass-effect action-btn-load"}," ËØªÂèñ ",8,Pt),a("button",{onClick:S=>M(b.id),class:"action-btn-save glass-effect"}," ‰øùÂ≠ò ",8,jt),a("button",{onClick:S=>g(b.id),class:"action-btn-delete glass-effect"}," Âà†Èô§ ",8,Ft)])]))),128))]))])])]),_:1})]),_:1}))}}),Ot=F(Lt,[["__scopeId","data-v-2e512fee"]]),Ht=j({__name:"SettingsText",setup(n){const e=m(),u=J(),o=c=>{e.value=c,u.typeWriterSpeed=c},t=c=>{console.log(c)},s=c=>{u.enableChatEffectSound=c};return(c,p)=>(f(),W(l(ae),null,{default:h(()=>[d(l(P),{title:"‚ö° ÊñáÂ≠óÊòæÁ§∫ÈÄüÂ∫¶"},{default:h(()=>[d(l(ce),{onChange:o},{default:h(()=>[...p[0]||(p[0]=[$("ÊÖ¢/Âø´",-1)])]),_:1})]),_:1}),d(l(P),{title:"üìù ÊòæÁ§∫ÊñáÂ≠óÊ†∑Êú¨"},{default:h(()=>[d(l(Ye),{speed:e.value},{default:h(()=>[...p[1]||(p[1]=[$("Ling Chat: ÊµãËØïÊñáÊú¨ÊòæÁ§∫ÈÄüÂ∫¶",-1)])]),_:1},8,["speed"])]),_:1}),d(l(P),{title:"‚ú® È°µÈù¢ÂàáÊç¢Âä®Áîª",size:"small"},{default:h(()=>[d(l(ie),{onChange:t},{default:h(()=>[...p[2]||(p[2]=[$("ÂêØÁî®Âä®ÁîªÊïàÊûú",-1)])]),_:1})]),_:1}),d(l(P),{title:"üåè ËØ≠Èü≥Èü≥ÊïàÂºÄÂÖ≥",size:"small"},{default:h(()=>[d(l(ie),{onChange:s},{default:h(()=>[...p[3]||(p[3]=[$("ÂêØÁî®Êó†vitsÊó∂ÁöÑÂØπËØùÈü≥Êïà",-1)])]),_:1})]),_:1}),d(l(P),{title:"‚ú® WebSocketÈÄö‰ø°Áä∂ÊÄÅ",size:"small"},{default:h(()=>[...p[4]||(p[4]=[a("p",null,"‚àö ËøûÊé•Ê≠£Â∏∏",-1)])]),_:1}),d(l(P),{title:"‚öô ÂΩìÂâç‰ΩøÁî®ÁöÑAIÂ§ßÊ®°Âûã",size:"small"},{default:h(()=>[...p[5]||(p[5]=[a("p",null,"DeepSeek V3",-1)])]),_:1})]),_:1}))}}),Nt=F(Ht,[["__scopeId","data-v-cac01c53"]]),Gt=async()=>{try{return await ee.get("/v1/chat/back-music/list")}catch(n){throw new Error(n.response?.data?.message||"Ëé∑ÂèñÈü≥‰πêÂàóË°®Â§±Ë¥•")}},Wt=async n=>{try{await ee.post("/v1/chat/back-music/upload",n)}catch(e){throw new Error(e.response?.data?.detail||"Â≠òÊ°£‰∏ä‰º†Â§±Ë¥•")}},qt=async n=>{try{await ee.delete("/v1/chat/back-music/delete",{params:{url:n}})}catch(e){throw new Error(e.response?.data?.detail||"Â≠òÊ°£‰∏ä‰º†Â§±Ë¥•")}},Kt={class:"sound-test"},Jt={class:"music-controls"},Qt={class:"music-name"},Yt={class:"music-list-container"},Xt={key:0,class:"empty-list"},Zt=["onClick"],ea={class:"music-item-name"},ta={class:"music-upload"},aa=j({__name:"SettingsSound",setup(n){const e=J(),u=m(null),o=m(null),t=m(null),s=m([]),c=m("Êú™ÈÄâÊã©Èü≥‰πê"),p=m(!1),y=m(null),k=m(null),x=v=>{u.value&&(u.value.volume=v/100)},M=v=>{o.value&&(o.value.volume=v/100)},g=v=>{t.value&&(t.value.volume=v/100)};U(()=>e.backgroundVolume,v=>{t.value&&(t.value.volume=v/100)});const r=()=>{u.value&&(u.value.src="/audio_effects/ËßíËâ≤Èü≥ÈáèÊµãËØï.wav",u.value.play().catch(v=>console.error("ÊµãËØïËßíËâ≤Èü≥ÈáèÊí≠ÊîæÂ§±Ë¥•:",v)))},i=()=>{o.value&&(o.value.src="/audio_effects/ÁñëÈóÆ.wav",o.value.play().catch(v=>console.error("ÊµãËØïÊ∞îÊ≥°Èü≥ÈáèÊí≠ÊîæÂ§±Ë¥•:",v)))},b=async()=>{s.value=await Gt()},S=async v=>{if(!v){console.log("musicÂØπË±°‰∏çÂ≠òÂú®");return}if(confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§„Ää${v.name}„ÄãÂêóÔºü`))try{await qt(v.url),console.log(`Ê≠£Âú®Âà†Èô§Èü≥‰πê: ${v.url}`),alert(`„Ää${v.name}„ÄãÂà†Èô§ÊàêÂäü`),await b()}catch(I){console.error("Âà†Èô§Èü≥‰πêÂ§±Ë¥•:",I),alert("Âà†Èô§Èü≥‰πêÂ§±Ë¥•")}},T=async()=>{if(!y.value){alert("ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™Èü≥‰πêÊñá‰ª∂");return}const v=y.value,I=[".mp3",".wav",".flac",".webm",".weba",".ogg",".m4a"],K=v.name.slice(v.name.lastIndexOf(".")).toLowerCase();if(!I.includes(K)){alert("‰∏çÊîØÊåÅÁöÑÈü≥È¢ëÊ†ºÂºè„ÄÇËØ∑‰∏ä‰º†: "+I.join(", "));return}const ue=new FormData;ue.append("file",v);try{await Wt(ue),console.log(`Ê≠£Âú®‰∏ä‰º†Êñá‰ª∂: ${v.name}`),alert("Èü≥‰πê‰∏ä‰º†ÊàêÂäü"),y.value=null,k.value&&(k.value.value=""),await b()}catch(xe){console.error("‰∏ä‰º†Èü≥‰πêÂ§±Ë¥•:",xe),alert("Èü≥‰πê‰∏ä‰º†Â§±Ë¥•")}},z=q(()=>p.value?"‚è∏ ÊöÇÂÅú":"‚ñ∂ Êí≠Êîæ"),D=v=>{if(!t.value)return;const I=`/api/v1/chat/back-music/music_file/${encodeURIComponent(v.url)}`;t.value.src=I,t.value.play().catch(K=>console.error("Êí≠ÊîæÈü≥‰πêÂ§±Ë¥•:",K)),c.value=v.name,p.value=!0},E=()=>{t.value&&(p.value?t.value.pause():!t.value.src&&s.value.length>0?D(s.value[0]):t.value.play().catch(v=>console.error("ÊÅ¢Â§çÊí≠ÊîæÂ§±Ë¥•:",v)),p.value=!t.value.paused)},A=()=>{t.value&&(t.value.pause(),t.value.currentTime=0,p.value=!1)},w=()=>{k.value?.click()},B=v=>{const I=v.target;I.files&&I.files.length>0?y.value=I.files[0]:y.value=null},Q=()=>{t.value&&(p.value=!t.value.paused)},V=()=>{p.value=!1};return Z(()=>{b(),u.value&&(u.value.volume=e.characterVolume/100),o.value&&(o.value.volume=e.bubbleVolume/100),t.value&&(t.value.volume=e.backgroundVolume/100)}),(v,I)=>(f(),W(l(ae),null,{default:h(()=>[d(l(P),{title:"üë© ËßíËâ≤Èü≥Èáè",size:"small"},{default:h(()=>[d(l(ce),{modelValue:l(e).characterVolume,"onUpdate:modelValue":I[0]||(I[0]=K=>l(e).characterVolume=K),onChange:x},{default:h(()=>[...I[3]||(I[3]=[$(" Âº±/Âº∫ ",-1)])]),_:1},8,["modelValue"])]),_:1}),d(l(P),{title:"üí¨ Ê∞îÊ≥°Èü≥Èáè",size:"small"},{default:h(()=>[d(l(ce),{onChange:M,modelValue:l(e).bubbleVolume,"onUpdate:modelValue":I[1]||(I[1]=K=>l(e).bubbleVolume=K)},{default:h(()=>[...I[4]||(I[4]=[$(" Âº±/Âº∫ ",-1)])]),_:1},8,["modelValue"])]),_:1}),d(l(P),{title:"üé∂ ËÉåÊôØÈü≥Èáè",size:"small"},{default:h(()=>[d(l(ce),{onChange:g,modelValue:l(e).backgroundVolume,"onUpdate:modelValue":I[2]||(I[2]=K=>l(e).backgroundVolume=K)},{default:h(()=>[...I[5]||(I[5]=[$(" Âº±/Âº∫ ",-1)])]),_:1},8,["modelValue"])]),_:1}),d(l(P),{title:"üîä Â£∞Èü≥ÊµãËØï",size:"small"},{default:h(()=>[a("div",Kt,[d(l(R),{type:"big",onClick:r},{default:h(()=>[...I[6]||(I[6]=[$("ÊµãËØïËßíËâ≤Èü≥Èáè",-1)])]),_:1}),d(l(R),{type:"big",onClick:i},{default:h(()=>[...I[7]||(I[7]=[$("ÊµãËØïÊ∞îÊ≥°Èü≥Èáè",-1)])]),_:1})])]),_:1}),d(l(P),{title:"‚öô ËÉåÊôØÈü≥‰πêËÆæÁΩÆ"},{default:h(()=>[a("div",Jt,[d(l(R),{type:"big",onClick:E,class:"left-button"},{default:h(()=>[$(C(z.value),1)]),_:1}),d(l(R),{type:"big",onClick:A,class:"left-button"},{default:h(()=>[...I[8]||(I[8]=[$("‚ñ† ÂÅúÊ≠¢",-1)])]),_:1}),a("span",Qt,"ÂΩìÂâç: "+C(c.value),1)]),a("div",Yt,[s.value.length===0?(f(),_("div",Xt," ÊöÇÊó†Èü≥‰πêÔºåËØ∑‰∏ä‰º† ")):G("",!0),(f(!0),_(O,null,X(s.value,K=>(f(),_("div",{key:K.url,class:"music-item",onClick:ue=>D(K)},[a("div",ea,C(K.name),1),d(l(R),{onClick:ue=>S(K),class:"action-btn-delete glass-effect"},{default:h(()=>[...I[9]||(I[9]=[$("Âà†Èô§",-1)])]),_:1},8,["onClick"])],8,Zt))),128))]),a("div",ta,[d(l(R),{type:"big",onClick:w},{default:h(()=>[...I[10]||(I[10]=[$("‚ûï Ê∑ªÂä†Èü≥‰πê",-1)])]),_:1}),a("input",{ref_key:"fileInput",ref:k,type:"file",onChange:B,accept:".mp3,.wav,.flac,.webm,.weba,.ogg,.m4a",style:{display:"none"}},null,544),d(l(R),{type:"big",onClick:T,disabled:!y.value},{default:h(()=>[...I[11]||(I[11]=[$("Á°ÆËÆ§‰∏ä‰º†",-1)])]),_:1},8,["disabled"])])]),_:1}),a("audio",{ref_key:"characterTestPlayer",ref:u},null,512),a("audio",{ref_key:"bubbleTestPlayer",ref:o},null,512),a("audio",{ref_key:"backgroundAudioPlayer",ref:t,loop:"",onTimeupdate:Q,onEnded:V},null,544)]),_:1}))}}),na=F(aa,[["__scopeId","data-v-74268141"]]),sa={class:"h-[87vh] w-full bg-white/10 p-0 md:p-4 rounded-lg overflow-auto"},oa={class:"block md:grid grid-cols-[280px_1fr] h-full"},la={key:0,class:"fixed inset-0 bg-white/80 flex justify-center items-center z-50"},ra={class:"text-base font-bold px-3.75 py-2.5 block rounded-lg mb-1 text-brand bg-white/10 backdrop-blur-xl backdrop-saturate-150 border border-white/10 shadow-[0_8px_32px_rgba(0,0,0,0.1),inset_0_1px_1px_rgba(255,255,255,0.1)]"},ia=["onClick"],ua={class:"flex justify-center h-full overflow-auto relative -top-full md:top-0 px-10 py-10 md:px-10 md:py-0"},ca={key:0,class:"w-full active"},da={class:"pt-2.5 overflow-auto"},pa={class:"pb-4 mb-6 border-b border-brand"},va={class:"m-0 text-2xl text-brand font-semibold"},fa={class:"mt-2 text-base"},ha={class:"inline-flex items-center cursor-pointer font-medium text-brand"},ga=["id","checked","onChange"],ma={class:"text-sm mt-1 mb-2 text-gray-300"},ba=["for"],ya={class:"text-sm mt-1 mb-2 text-gray-300"},_a=["id","onUpdate:modelValue"],ka=["for"],wa={class:"text-sm mt-1 mb-2 text-gray-300"},xa=["id","onUpdate:modelValue"],Ca={class:"w-18 px-5 py-2.5 bg-brand text-white border-none rounded-lg cursor-pointer text-sm font-medium transition-colors duration-200 hover:bg-[#0056b3]"},$a={key:1,class:"w-full active"},Sa=j({__name:"SettingsAdvance",emits:["remove-more-menu-from-b"],setup(n,{expose:e,emit:u}){const o=m(!1),t=m({}),s=be({category:null,subcategory:null}),c=be({message:"",color:"var(--success-color)"}),p=u,y=m(null),k=m(null),x=q(()=>s.category&&s.subcategory?t.value[s.category]?.subcategories[s.subcategory]:null),M=(E,A)=>s.category===E&&s.subcategory===A,g=(E,A)=>{s.category=E,s.subcategory=A},r=(E,A)=>{E.value=A?"true":"false"},i=async()=>{if(!x.value)return;const E={};x.value.settings.forEach(A=>{E[A.key]=A.value}),o.value=!0,c.message="";try{const A=await fetch("/api/settings/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),w=await A.json();if(!A.ok)throw new Error(w.detail||"‰øùÂ≠òÂ§±Ë¥•");c.message=w.message,c.color="var(--success-color)",await b(!1)}catch(A){c.message=`ÈîôËØØ: ${A.message}`,c.color="red"}finally{o.value=!1,setTimeout(()=>{c.message=""},5e3)}},b=async(E=!0)=>{o.value=!0;try{const A=await fetch("/api/settings/config");if(!A.ok)throw new Error("Êó†Ê≥ïÂä†ËΩΩÈÖçÁΩÆ");if(t.value=await A.json(),E&&Object.keys(t.value).length>0){const w=Object.keys(t.value)[0],B=Object.keys(t.value[w].subcategories)[0];w&&B&&g(w,B)}}catch(A){console.error(A),c.message=`Âä†ËΩΩÈÖçÁΩÆÂ§±Ë¥•: ${A.message}`,c.color="red"}finally{o.value=!1}},S=()=>{if(!y.value||!k.value)return;const E=y.value.querySelector(".adv-nav-link.active");if(E){const A=E.offsetTop,w=E.offsetHeight;A&&(k.value.style.top=`${A}px`),w&&(k.value.style.height=`${w}px`)}},T=()=>{if(!y.value)return;new ResizeObserver(A=>{S()}).observe(y.value)};U(s,async()=>{await le(),S()},{deep:!0}),Z(async()=>{await b(),await le(),S(),T()});const z=()=>{const E=y.value;E&&E.classList.add("moreMenu")},D=()=>{const E=y.value;E&&E.classList.remove("moreMenu"),p("remove-more-menu-from-b")};return e({addMoreMenu:z}),(E,A)=>(f(),W(l(ae),null,{default:h(()=>[a("div",sa,[a("div",oa,[o.value?(f(),_("div",la,[...A[1]||(A[1]=[a("div",{class:"border-5 border-gray-200 border-t-brand rounded-full w-12 h-12 animate-spin"},null,-1)])])):G("",!0),a("nav",{ref_key:"navContainerRef",ref:y,onClick:A[0]||(A[0]=()=>D()),class:"-left-full md:left-0 blur transition-all duration-300 ease-[cubic-bezier(0.18,0.89,0.32,1.00)] md:blur-none h-full p-5 flex flex-col justify-start gap-6.25 overflow-y-auto relative border-r border-brand md:moreMenu:left-0"},[a("div",{ref_key:"indicatorRef",ref:k,class:"absolute left-5 w-[calc(100%-40px)] bg-brand rounded-lg z-0 transition-all duration-300 ease-[cubic-bezier(0.18,0.89,0.32,1.00)]"},null,512),(f(!0),_(O,null,X(t.value,(w,B)=>(f(),_("div",{key:B,class:"flex flex-col gap-1 w-full"},[a("span",ra,C(B),1),(f(!0),_(O,null,X(w.subcategories,(Q,V)=>(f(),_("a",{key:V,href:"#",class:N(["block px-5 py-3 no-underline rounded-lg text-white transition-colors duration-200 relative z-10 adv-nav-link hover:bg-gray-200 hover:text-black active:text-white active:font-bold",{active:M(B,V.toString())}]),onClick:he(v=>g(B,V.toString()),["prevent"])},C(V),11,ia))),128))]))),128))],512),a("main",ua,[x.value?(f(),_("div",ca,[a("div",da,[a("header",pa,[a("h2",va,C(s.subcategory),1),a("p",fa,C(x.value.description||`‰øÆÊîπ ${s.subcategory} ÁöÑÁõ∏ÂÖ≥ÈÖçÁΩÆ`),1)]),a("form",{onSubmit:he(i,["prevent"])},[(f(!0),_(O,null,X(x.value.settings,w=>(f(),_("div",{key:w.key,class:"mb-6"},[w.type==="bool"?(f(),_(O,{key:0},[a("label",ha,[a("input",{class:"mr-2.5 w-4 h-4",type:"checkbox",id:w.key,checked:w.value.toLowerCase()==="true",onChange:B=>r(w,B.target.checked)},null,40,ga),$(" "+C(w.key),1)]),a("p",ma,C(w.description||""),1)],64)):w.type==="textarea"?(f(),_(O,{key:1},[a("label",{class:"inline-flex items-center cursor-pointer font-medium text-brand",for:w.key},C(w.key),9,ba),a("p",ya,C(w.description||"ÊîØÊåÅÂ§öË°åËæìÂÖ•"),1),H(a("textarea",{id:w.key,"onUpdate:modelValue":B=>w.value=B,class:"w-full px-3 py-2.5 border rounded-lg text-sm text-white bg-white/10 backdrop-blur-xl backdrop-saturate-150 border-white/10 shadow-glass focus:outline-none focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all duration-200",rows:"8"},null,8,_a),[[de,w.value]])],64)):(f(),_(O,{key:2},[a("label",{class:"inline-flex items-center cursor-pointer font-medium text-brand",for:w.key},C(w.key),9,ka),a("p",wa,C(w.description||""),1),H(a("input",{type:"text",id:w.key,"onUpdate:modelValue":B=>w.value=B,class:"w-full px-3 py-2.5 border rounded-lg text-sm text-white bg-white/10 backdrop-blur-xl backdrop-saturate-150 border-white/10 shadow-glass focus:outline-none focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all duration-200"},null,8,xa),[[de,w.value]])],64))]))),128))],32),a("div",Ca,[a("button",{onClick:i},"‰øùÂ≠ò"),a("p",{style:te({color:c.color})},C(c.message),5)])])])):!o.value&&!Object.keys(t.value).length?(f(),_("div",$a,[...A[2]||(A[2]=[a("div",{class:"advanced-settings-container"},[a("header",null,[a("h2",{class:"adv-title"},"Âä†ËΩΩÂ§±Ë¥•"),a("p",{class:"adv-description"},"Êó†Ê≥ïÂä†ËΩΩÈÖçÁΩÆÊàñÈÖçÁΩÆ‰∏∫Á©∫„ÄÇ")])],-1)])])):G("",!0)])])])]),_:1}))}}),Ma={class:"name"},Aa={class:"content"},Ba=j({__name:"DialogUser",props:{name:{type:String,require:!0},content:{type:String,require:!0}},setup(n){return(e,u)=>(f(),_(O,null,[a("span",Ma,C(n.name),1),u[0]||(u[0]=a("span",null,": ",-1)),a("span",Aa,C(n.content),1)],64))}}),Ia=F(Ba,[["__scopeId","data-v-9c1ad178"]]),Ta=["title"],Ea={class:"name"},Ra={class:"content"},za={class:"icon"},Va=j({__name:"DialogCharacter",props:{name:{type:String,require:!0},content:{type:String,require:!0},emotionTag:{type:String,require:!0},emotionText:{type:String,require:!0}},emits:["click"],setup(n,{emit:e}){return(u,o)=>(f(),_("div",{class:"message",title:`ÊÉÖÊÑü: ${n.emotionTag}`},[a("span",Ea,C(n.name),1),o[1]||(o[1]=a("span",{class:"symbol"},":¬†",-1)),a("span",Ra,C(n.content),1),o[2]||(o[2]=a("span",{class:"symbol"},"¬†",-1)),a("span",za,[d(l(me),{icon:"volume",onClick:o[0]||(o[0]=t=>u.$emit("click"))})])],8,Ta))}}),Da=F(Va,[["__scopeId","data-v-ba0ab136"]]),Ua={class:"message-item"},Pa={key:0,class:"player-message"},ja={key:1,class:"chararter-reply"},Fa={key:2,class:"final-spacer"},La=j({__name:"DialogSession",props:{dialog:{type:Array,require:!0}},setup(n){const e=m(null);function u(o){e.value.src=`${L.VOICE.BASE}/${o}`,e.value.play()}return(o,t)=>(f(),_(O,null,[(f(!0),_(O,null,X(n.dialog,s=>(f(),_("div",Ua,[s.type==="message"?(f(),_("div",Pa,[d(Ia,{name:s.character,content:s.content},null,8,["name","content"])])):s.type==="reply"?(f(),_("div",ja,[d(Da,{name:s.character,content:s.content,emotionTag:s.originalTag,emotionText:s.motionText,onClick:c=>u(s.audioFile)},null,8,["name","content","emotionTag","emotionText","onClick"])])):G("",!0),s.isFinal?(f(),_("div",Fa)):G("",!0)]))),256)),a("audio",{ref_key:"audio",ref:e,autoplay:""},null,512)],64))}}),Oa=F(La,[["__scopeId","data-v-a2ba1178"]]),Ha={class:"history-container"},Na={key:0,class:"status-message"},Ga=j({__name:"SettingsHistory",setup(n){const e=re(),u=q(()=>e.dialogHistory),o=m(null);return(t,s)=>(f(),W(l(ae),null,{default:h(()=>[d(l(P),{title:"‚óà ÂéÜÂè≤ÂØπËØù"},{default:h(()=>[a("div",Ha,[u.value.length===0?(f(),_("div",Na," ÊöÇÊó†ÂéÜÂè≤ËÆ∞ÂΩïÔºåÂéªÂíåtaËÅäËÅäÂ§©Âè≠(*^‚ñΩ^*) ")):(f(),_("div",{key:1,class:"chat-history-container",ref_key:"chatContainer",ref:o},[d(Oa,{dialog:u.value},null,8,["dialog"])],512))])]),_:1})]),_:1}))}}),Wa=F(Ga,[["__scopeId","data-v-0dfd3249"]]),qa=j({__name:"SettingsSchedule",setup(n){return(e,u)=>(f(),W(l(ae),null,{default:h(()=>[d(l(P),{title:"‰∏ªÂä®ÊèêÈÜíÔºàËØ∑ÂéªÈ´òÁ∫ßËÆæÁΩÆ-ÂÆûÈ™åÂäüËÉΩËÆæÁΩÆÔºâ",size:"small"},{default:h(()=>[d(l(ie),null,{default:h(()=>[...u[0]||(u[0]=[$("ÊòØÂê¶ÂºÄÂêØÊó•Á®ã‰∏ªÂä®ÊèêÈÜíÂäüËÉΩ",-1)])]),_:1})]),_:1}),d(l(P),{title:"ÈöèÊú∫ËÅäÂ§©ÔºàÊï¨ËØ∑ÊúüÂæÖÔºâ",size:"small"},{default:h(()=>[d(l(ie),null,{default:h(()=>[...u[1]||(u[1]=[$("ÊòØÂê¶ÂºÄÂêØÈöèÊú∫Èó¥Èöî‰∏ªÂä®ËÅäÂ§©ÂäüËÉΩ",-1)])]),_:1})]),_:1}),d(l(P),{title:"Á™•Â±èÊùÉÈôêÔºàÊï¨ËØ∑ÊúüÂæÖÔºâ",size:"small"},{default:h(()=>[d(l(ie),null,{default:h(()=>[...u[2]||(u[2]=[$("ÊòØÂê¶ÂºÄÂêØ‰∏ªÂä®Á™•Â±èËÅäÂ§©ÂäüËÉΩ",-1)])]),_:1})]),_:1}),d(l(P),{title:"Êó•Á®ãÂàóË°®ÔºàÊï¨ËØ∑ÊúüÂæÖÔºâ",size:"large"},{default:h(()=>[...u[3]||(u[3]=[$(" Êó•Á®ãÁªÑ‰ª∂ ",-1)])]),_:1})]),_:1}))}}),Ka={class:"character-card"},Ja={class:"character-avatar-container"},Qa=["src","alt"],Ya={class:"character-content"},Xa={class:"character-title"},Za={class:"character-description"},en={class:"character-actions"},tn=j({__name:"CharacterCard",props:{avatar:{},name:{},info:{}},setup(n){return(e,u)=>(f(),_("div",Ka,[a("div",Ja,[a("img",{src:n.avatar,alt:n.name,class:"character-avatar"},null,8,Qa)]),a("div",Ya,[a("h5",Xa,C(n.name),1),a("p",Za,C(n.info),1),a("div",en,[se(e.$slots,"actions",{},void 0,!0)])])]))}}),an=F(tn,[["__scopeId","data-v-1f2f7db6"]]),nn={},sn={class:"grid grid-cols-1 gap-5"};function on(n,e){return f(),_("div",sn,[se(n.$slots,"default")])}const ln=F(nn,[["render",on]]),rn=async()=>{try{return await ee.get("/v1/chat/character/get_all_characters")}catch(n){throw new Error(n.response?.data?.message||"Ëé∑ÂèñËßíËâ≤ÂàóË°®Â§±Ë¥•")}},un=async n=>{try{return(await ee.post("/v1/chat/character/select_character",n)).data}catch(e){throw new Error(e.response?.data?.detail||"ËßíËâ≤ÈÄâÊã©Â§±Ë¥•")}},cn={class:"character-list character-grid"},dn=j({__name:"SettingsCharacter",setup(n){const e=m([]),u=m(1),o=re(),t=ge(),s=async()=>{try{return(await rn()).map(r=>({id:parseInt(r.character_id),title:r.title,info:r.info||"ÊöÇÊó†ËßíËâ≤ÊèèËø∞",avatar:r.avatar_path?`/api/v1/chat/character/character_file/${encodeURIComponent(r.avatar_path)}`:"../pictures/characters/default.png"}))}catch(g){return console.error("Ëé∑ÂèñËßíËâ≤ÂàóË°®Â§±Ë¥•:",g),[]}},c=async()=>{try{const g=await s();e.value=g}catch(g){console.error("Âä†ËΩΩËßíËâ≤Â§±Ë¥•:",g)}},p=async()=>{await o.initializeGame(t.client_id,"1")},y=async g=>{try{await un({user_id:u.value.toString(),character_id:g.toString()}),p()}catch(r){console.error("ÂàáÊç¢ËßíËâ≤Â§±Ë¥•:",r)}},k=async()=>{try{const g=await fetch("/api/v1/chat/character/refresh_characters",{method:"POST",headers:{"Content-Type":"application/json"}});if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);await g.json(),alert("Âà∑Êñ∞ÊàêÂäü"),await c()}catch(g){alert("Âà∑Êñ∞Â§±Ë¥•"),console.error("Âà∑Êñ∞Â§±Ë¥•:",g)}},x=async()=>{try{const g=await fetch("/api/v1/chat/character/open_web");if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);await g.json()}catch(g){alert("ÂêØÂä®Â§±Ë¥•ÔºåËØ∑ÊâãÂä®ÂéªlingchatÁöÑdiscussionÁΩëÈ°µ"),console.error("ÊâìÂºÄÂàõÊÑèÂ∑•ÂùäÂ§±Ë¥•:",g)}};function M(g){return o.avatar.character_id===g}return Z(()=>{c()}),(g,r)=>(f(),W(l(ae),null,{default:h(()=>[d(l(P),{title:"ËßíËâ≤ÂàóË°®"},{default:h(()=>[d(ln,null,{default:h(()=>[a("div",cn,[(f(!0),_(O,null,X(e.value,i=>(f(),W(an,{key:i.id,avatar:i.avatar,name:i.title,info:i.info},{actions:h(()=>[d(l(R),{type:"select",class:N(["character-select-btn",{selected:M(i.id)}]),onClick:b=>y(i.id)},{default:h(()=>[$(C(M(i.id)?"‚àö ÈÄâ‰∏≠":"ÈÄâÊã©"),1)]),_:2},1032,["class","onClick"])]),_:2},1032,["avatar","name","info"]))),128))])]),_:1})]),_:1}),d(l(P),{title:"Âà∑Êñ∞‰∫∫Áâ©ÂàóË°®",size:"small"},{default:h(()=>[d(l(R),{type:"big",onClick:k},{default:h(()=>[...r[0]||(r[0]=[$("ÁÇπÊàëÂà∑Êñ∞~",-1)])]),_:1})]),_:1}),d(l(P),{title:"ÂàõÊÑèÂ∑•Âùä",size:"small"},{default:h(()=>[d(l(R),{type:"big",onClick:x},{default:h(()=>[...r[1]||(r[1]=[$("ËøõÂÖ•ÂàõÊÑèÂ∑•Âùä",-1)])]),_:1})]),_:1})]),_:1}))}}),pn=F(dn,[["__scopeId","data-v-af509e38"]]),vn=async()=>{try{return await ee.get("/v1/chat/background/list",{})}catch(n){throw console.error("Ëé∑ÂèñÊ∏∏Êàè‰ø°ÊÅØÈîôËØØ:",n.message),n}},fn={class:"background-container"},hn={class:"background-list character-grid"},gn={class:"background-image-container"},mn=["src","alt"],bn=["data-title"],yn={class:"effect-list"},_n=j({__name:"SettingsBackground",setup(n){const e=m([]),u=m(""),o=m(null),t=J();Z(async()=>{try{await c();const g=localStorage.getItem("selectedBackground");if(g)y(g);else if(e.value.length>0){const r=Math.floor(Math.random()*e.value.length);y(e.value[r].url),console.log("Â∑≤ÈÄâÈöèÊú∫ËÉåÊôØ")}}catch(g){console.error("Âä†ËΩΩËÉåÊôØÂõæÁâáÂ§±Ë¥•",g)}});async function s(){try{return(await vn()).map(r=>({title:r.title?r.title:"ËçâÊ≥•È©¨",url:r.url?`/api/v1/chat/background/background_file/${encodeURIComponent(r.url)}`:"../pictures/background/default.png",time:r.time}))}catch(g){return console.error("Ëé∑ÂèñËÉåÊôØÂàóË°®Â§±Ë¥•:",g),[]}}async function c(){e.value=await s()}function p(g){return u.value===g}function y(g){u.value=g,t.currentBackground=g,localStorage.setItem("selectedBackground",g)}function k(){o.value&&o.value.click()}async function x(g){const r=g.target,i=r.files?.[0];if(!i)return;const b=i.name,S=b.slice(b.lastIndexOf(".")).toLowerCase(),T=[".jpg",".png",".webp",".bmp",".svg",".tif",".gif"];if(!T.includes(S)){alert("ËØ∑‰∏ä‰º†ÊîØÊåÅÁöÑÂõæÁâáÊ†ºÂºè: "+T.join(", "));return}const z=new FormData;z.append("file",i),z.append("name",b);try{if(!(await fetch("/api/v1/chat/background/upload",{method:"POST",body:z})).ok)throw new Error("‰∏ä‰º†Â§±Ë¥•");await c(),r&&(r.value="")}catch(D){console.error("‰∏ä‰º†Â§±Ë¥•",D),alert("‰∏ä‰º†Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}}function M(g){t.currentBackgroundEffect=g}return(g,r)=>(f(),W(l(ae),null,{default:h(()=>[d(l(P),{title:"ËÉåÊôØÈÄâÊã©"},{default:h(()=>[a("div",fn,[a("div",hn,[(f(!0),_(O,null,X(e.value,(i,b)=>(f(),_("div",{key:b,class:N(["background-card",{selected:p(i.url)}])},[a("div",gn,[a("img",{src:i.url,alt:i.title,class:"background-image"},null,8,mn)]),a("div",{class:"background-title","data-title":i.title},[d(l(R),{class:N(["background-select-btn",{selected:p(i.url)}]),onClick:S=>y(i.url)},{default:h(()=>[$(C(p(i.url)?"Â∑≤ÈÄâ‰∏≠":"ÈÄâÊã©"),1)]),_:2},1032,["class","onClick"])],8,bn)],2))),128))]),d(l(R),{type:"big",onClick:k},{default:h(()=>[...r[4]||(r[4]=[$("‰∏ä‰º†Ëá™ÂÆö‰πâËÉåÊôØ",-1)])]),_:1}),a("input",{type:"file",ref_key:"uploadInput",ref:o,onChange:x,accept:".jpg,.png,.webp,.bmp,.svg,.tif,.gif",style:{display:"none"}},null,544)])]),_:1}),d(l(P),{title:"Á≤íÂ≠êÈÄâÊã©",size:"large"},{default:h(()=>[a("div",yn,[d(l(R),{type:"big",onClick:r[0]||(r[0]=i=>M("StarField"))},{default:h(()=>[...r[5]||(r[5]=[$("ÊòüÁ©∫",-1)])]),_:1}),d(l(R),{type:"big",onClick:r[1]||(r[1]=i=>M("Rain"))},{default:h(()=>[...r[6]||(r[6]=[$("Èõ®Ê∞¥",-1)])]),_:1}),d(l(R),{type:"big",onClick:r[2]||(r[2]=i=>M("Sakura"))},{default:h(()=>[...r[7]||(r[7]=[$("Ê®±Ëä±",-1)])]),_:1}),d(l(R),{type:"big",onClick:r[3]||(r[3]=i=>M("Snow"))},{default:h(()=>[...r[8]||(r[8]=[$("Èõ™ÊôØ",-1)])]),_:1})])]),_:1})]),_:1}))}}),kn=F(_n,[["__scopeId","data-v-15da53dd"]]),wn={name:"SettingsUpdate",components:{MenuPage:ae,MenuItem:P,Button:R},data(){return{apiBaseUrl:"/api/v1/update",currentVersion:"Êú™Áü•",updateAvailable:!1,updateStatus:"idle",updateInfo:null,updateChain:[],updateChainInfo:null,errorMessage:"",isChecking:!1,isDownloading:!1,isRollingBack:!1,progress:0,progressMessage:"",showProgress:!1,config:{auto_backup:!0},backendConnected:!1,connectionRetries:0,maxRetries:5,showRollbackDialog:!1,showBackupDialog:!1,statusPolling:null}},mounted(){this.checkBackendConnection()},beforeUnmount(){this.stopStatusPolling()},computed:{isCheckingUpdates(){return this.updateStatus==="checking"},isDownloadingUpdates(){return this.updateStatus==="downloading"},isApplyingUpdates(){return this.updateStatus==="applying"},isRollingBackUpdates(){return this.updateStatus==="rolling_back"},displayVersion(){return this.updateInfo&&(this.updateInfo.target_version||this.updateInfo.version)||"Êú™Áü•"}},methods:{async checkBackendConnection(){try{const n=await ne.get(`${this.apiBaseUrl}/health`,{timeout:5e3});n.data&&n.data.status==="ok"&&(this.backendConnected=!0,this.connectionRetries=0,this.errorMessage="",this.loadAppInfo(),this.loadConfig(),this.startStatusPolling(),console.log("ÊàêÂäüËøûÊé•Âà∞Êõ¥Êñ∞ÊúçÂä°"))}catch(n){console.error("Êó†Ê≥ïËøûÊé•Âà∞ÂêéÁ´ØÊúçÂä°:",n),this.backendConnected=!1,this.connectionRetries<this.maxRetries?(this.connectionRetries++,console.log(`ÈáçËØïËøûÊé• (${this.connectionRetries}/${this.maxRetries})...`),setTimeout(()=>this.checkBackendConnection(),2e3)):(this.errorMessage=`Êó†Ê≥ïËøûÊé•Âà∞Êõ¥Êñ∞ÊúçÂä°„ÄÇËØ∑Á°Æ‰øù‰∏ªÂ∫îÁî®ÊúçÂä°Ê≠£Âú®ËøêË°å„ÄÇÈîôËØØ: ${n.message}`,this.stopStatusPolling())}},async loadAppInfo(){if(this.backendConnected)try{const n=await ne.get(`${this.apiBaseUrl}/info`,{timeout:5e3});n.data&&(this.currentVersion=n.data.current_version||"Êú™Áü•",this.updateAvailable=n.data.update_available||!1,this.updateChainInfo=n.data.update_chain_info||null)}catch(n){console.error("Ëé∑ÂèñÂ∫îÁî®‰ø°ÊÅØÂ§±Ë¥•:",n),this.handleApiError(n,"Ëé∑ÂèñÂ∫îÁî®‰ø°ÊÅØ")}},async loadConfig(){if(this.backendConnected)try{const n=await ne.get(`${this.apiBaseUrl}/config`,{timeout:5e3});n.data&&(this.config.auto_backup=n.data.auto_backup||!0)}catch(n){console.error("Ëé∑ÂèñÈÖçÁΩÆÂ§±Ë¥•:",n),this.handleApiError(n,"Ëé∑ÂèñÈÖçÁΩÆ")}},async updateConfig(){if(this.backendConnected)try{await ne.post(`${this.apiBaseUrl}/config`,this.config,{timeout:5e3})}catch(n){console.error("Êõ¥Êñ∞ÈÖçÁΩÆÂ§±Ë¥•:",n),this.handleApiError(n,"Êõ¥Êñ∞ÈÖçÁΩÆ")}},startStatusPolling(){this.stopStatusPolling(),this.statusPolling=setInterval(async()=>{await this.getUpdateStatus()},1e3)},stopStatusPolling(){this.statusPolling&&(clearInterval(this.statusPolling),this.statusPolling=null)},async getUpdateStatus(){if(this.backendConnected)try{const n=await ne.get(`${this.apiBaseUrl}/status`,{timeout:5e3});if(n.data){const e=n.data;this.updateStatus=e.status||"idle",this.progress=e.progress||0,this.progressMessage=e.message||"",this.isChecking=this.updateStatus==="checking",this.isDownloading=["downloading","applying"].includes(this.updateStatus),this.isRollingBack=this.updateStatus==="rolling_back",e.error?this.errorMessage=e.error:this.updateStatus!=="error"&&(this.errorMessage=""),e.update_info&&(this.updateInfo=e.update_info,this.updateAvailable=!0,e.update_info.update_chain&&e.update_info.update_chain.length>0?this.updateChain=e.update_info.update_chain:this.updateChain=[]),this.showProgress=["checking","downloading","applying","rolling_back"].includes(this.updateStatus),this.updateStatus==="completed"&&setTimeout(()=>{this.loadAppInfo(),this.updateAvailable=!1,this.updateInfo=null,this.updateChain=[]},1e3)}}catch(n){console.error("Ëé∑ÂèñÊõ¥Êñ∞Áä∂ÊÄÅÂ§±Ë¥•:",n),this.handleApiError(n,"Ëé∑ÂèñÊõ¥Êñ∞Áä∂ÊÄÅ")}},handleApiError(n,e){n.code==="NETWORK_ERROR"||n.message.includes("Network Error")?(this.backendConnected=!1,this.errorMessage="ÁΩëÁªúÈîôËØØ: Êó†Ê≥ïËøûÊé•Âà∞Êõ¥Êñ∞ÊúçÂä°„ÄÇËØ∑Á°Æ‰øù‰∏ªÂ∫îÁî®ÊúçÂä°Ê≠£Âú®ËøêË°å„ÄÇ",this.stopStatusPolling()):n.response?this.errorMessage=`${e}Â§±Ë¥•: ÊúçÂä°Âô®ËøîÂõûÈîôËØØ ${n.response.status}`:n.request?(this.backendConnected=!1,this.errorMessage=`${e}Â§±Ë¥•: Êó†Ê≥ïËøûÊé•Âà∞ÊúçÂä°Âô®`,this.stopStatusPolling()):this.errorMessage=`${e}Â§±Ë¥•: ${n.message}`},async checkForUpdates(){this.errorMessage="";try{const n=await ne.post(`${this.apiBaseUrl}/check`,{},{timeout:1e4});n.data&&n.data.success?this.progressMessage="Ê≠£Âú®Ê£ÄÊü•Êõ¥Êñ∞...":this.errorMessage=n.data.error||"Ê£ÄÊü•Êõ¥Êñ∞Â§±Ë¥•"}catch(n){console.error("Ê£ÄÊü•Êõ¥Êñ∞Â§±Ë¥•:",n),this.handleApiError(n,"Ê£ÄÊü•Êõ¥Êñ∞")}},async downloadAndApplyUpdate(){this.errorMessage="",this.updateChain&&this.updateChain.length>1?this.showBackupDialog=!0:await this.startUpdate(this.config.auto_backup)},async startUpdate(n){try{const e=await ne.post(`${this.apiBaseUrl}/apply`,{backup:n},{timeout:3e4});e.data&&e.data.success?this.progressMessage="ÂºÄÂßã‰∏ãËΩΩÊõ¥Êñ∞...":this.errorMessage=e.data.error||"ÂºÄÂßãÊõ¥Êñ∞Â§±Ë¥•"}catch(e){console.error("ÂºÄÂßãÊõ¥Êñ∞Â§±Ë¥•:",e),this.handleApiError(e,"ÂºÄÂßãÊõ¥Êñ∞")}},confirmUpdateWithBackup(n){this.showBackupDialog=!1,this.startUpdate(n)},cancelUpdate(){this.showBackupDialog=!1},rollbackUpdate(){this.showRollbackDialog=!0},async confirmRollback(){this.showRollbackDialog=!1,this.errorMessage="";try{const n=await ne.post(`${this.apiBaseUrl}/rollback`,{},{timeout:3e4});n.data&&n.data.success?this.progressMessage="Ê≠£Âú®ÂõûÊªö...":this.errorMessage=n.data.error||"ÂºÄÂßãÂõûÊªöÂ§±Ë¥•"}catch(n){console.error("ÂºÄÂßãÂõûÊªöÂ§±Ë¥•:",n),this.handleApiError(n,"ÂºÄÂßãÂõûÊªö")}},cancelRollback(){this.showRollbackDialog=!1}}},xn={key:0,class:"connection-status error"},Cn={key:1,class:"connection-status success"},$n={class:"current-version"},Sn={key:0,class:"update-chain-info"},Mn={key:1,class:"error-message"},An={class:"action-buttons"},Bn={class:"update-info"},In={key:0},Tn={key:1},En={class:"progress-container"},Rn={class:"progress-bar"},zn={class:"progress-text"},Vn={class:"config-item"},Dn={key:2,class:"dialog-overlay"},Un={class:"dialog"},Pn={class:"dialog-actions"},jn={key:3,class:"dialog-overlay"},Fn={class:"dialog"},Ln={class:"dialog-actions"};function On(n,e,u,o,t,s){const c=ve("Button"),p=ve("MenuItem"),y=ve("MenuPage");return f(),W(y,null,{default:h(()=>[d(p,{title:"üîó Êõ¥Êñ∞ÊúçÂä°ËøûÊé•Áä∂ÊÄÅ",size:"small"},{default:h(()=>[t.backendConnected?(f(),_("div",Cn,[...e[7]||(e[7]=[a("p",null,"‚úÖ Â∑≤ËøûÊé•Âà∞Êõ¥Êñ∞ÊúçÂä°",-1)])])):(f(),_("div",xn,[e[5]||(e[5]=a("p",null,"‚ö†Ô∏è Êú™ËøûÊé•Âà∞Êõ¥Êñ∞ÊúçÂä°",-1)),e[6]||(e[6]=a("p",null,"ËØ∑Á°Æ‰øù‰∏ªÂ∫îÁî®ÊúçÂä°Ê≠£Âú®ËøêË°åÔºà‰∏ÄËà¨‰∏çÂèØËÉΩÂú®ÈùûËøêË°åÁä∂ÊÄÅÔºâ",-1)),d(c,{type:"big",onClick:s.checkBackendConnection},{default:h(()=>[...e[4]||(e[4]=[$("ÈáçËØïËøûÊé•",-1)])]),_:1},8,["onClick"])]))]),_:1}),d(p,{title:"üìã ÂΩìÂâçÁâàÊú¨‰ø°ÊÅØ",size:"small"},{default:h(()=>[a("div",$n,[a("p",null,[e[8]||(e[8]=a("strong",null,"ÂΩìÂâçÁâàÊú¨:",-1)),$(" "+C(t.currentVersion),1)]),a("p",null,[e[9]||(e[9]=a("strong",null,"Êõ¥Êñ∞Áä∂ÊÄÅ:",-1)),$(" "+C(t.updateStatus),1)]),t.updateChainInfo&&t.updateChainInfo.update_count>1?(f(),_("p",Sn," ÂèëÁé∞ "+C(t.updateChainInfo.update_count)+" ‰∏™ÂæÖÊõ¥Êñ∞ÁâàÊú¨: "+C(t.updateChainInfo.current_version)+" ‚Üí "+C(t.updateChainInfo.target_version),1)):G("",!0),t.errorMessage?(f(),_("p",Mn,C(t.errorMessage),1)):G("",!0)])]),_:1}),d(p,{title:"üîÑ Êõ¥Êñ∞Êìç‰Ωú",size:"large"},{default:h(()=>[a("div",An,[d(c,{type:"big",onClick:s.checkForUpdates,disabled:!t.backendConnected||t.isChecking||t.isDownloading||t.isRollingBack,class:"left-button"},{default:h(()=>[$(C(t.isChecking?"‚è≥ Ê£ÄÊü•‰∏≠...":"üîç Ê£ÄÊü•Êõ¥Êñ∞"),1)]),_:1},8,["onClick","disabled"]),d(c,{type:"big",onClick:s.downloadAndApplyUpdate,disabled:!t.backendConnected||!t.updateAvailable||t.isChecking||t.isDownloading||t.isRollingBack,class:"left-button"},{default:h(()=>[$(C(t.isDownloading?"‚è≥ ‰∏ãËΩΩ‰∏≠...":"üì• ‰∏ãËΩΩÂπ∂Â∫îÁî®Êõ¥Êñ∞"),1)]),_:1},8,["onClick","disabled"]),d(c,{type:"big",onClick:s.rollbackUpdate,disabled:!t.backendConnected||t.isChecking||t.isDownloading||t.isRollingBack,class:"left-button danger"},{default:h(()=>[$(C(t.isRollingBack?"‚è≥ ÂõûÊªö‰∏≠...":"‚Ü©Ô∏è ÂõûÊªöÂà∞‰∏äÊ¨°Â§á‰ªΩ"),1)]),_:1},8,["onClick","disabled"])])]),_:1}),t.updateInfo?(f(),W(p,{key:0,title:"üÜï ÂèëÁé∞Êñ∞ÁâàÊú¨",size:"small"},{default:h(()=>[a("div",Bn,[t.updateChain&&t.updateChain.length>0?(f(),_("div",In,[a("p",null,[a("strong",null,"ÂèëÁé∞ "+C(t.updateChain.length)+" ‰∏™ÂæÖÊõ¥Êñ∞ÁâàÊú¨:",1)]),(f(!0),_(O,null,X(t.updateChain,(k,x)=>(f(),_("div",{key:x,class:"update-chain-item"},[a("p",null,[a("strong",null,"ÁâàÊú¨ "+C(k.version||"Êú™Áü•"),1),$(" - "+C(k.changelog||"Êó†Êõ¥Êñ∞ËØ¥Êòé"),1)])]))),128))])):(f(),_("div",Tn,[a("p",null,[e[10]||(e[10]=a("strong",null,"ÁâàÊú¨:",-1)),$(" "+C(s.displayVersion),1)]),a("p",null,[e[11]||(e[11]=a("strong",null,"Êõ¥Êñ∞ÂÜÖÂÆπ:",-1)),$(" "+C(t.updateInfo.changelog||"Êó†"),1)])]))])]),_:1})):G("",!0),t.showProgress?(f(),W(p,{key:1,title:"üìä Êõ¥Êñ∞ËøõÂ∫¶",size:"small"},{default:h(()=>[a("div",En,[a("div",Rn,[a("div",{class:"progress-fill",style:te({width:t.progress+"%"})},null,4)]),a("p",zn,C(t.progressMessage),1)])]),_:1})):G("",!0),d(p,{title:"‚öô Êõ¥Êñ∞ÈÖçÁΩÆ"},{default:h(()=>[a("div",Vn,[a("label",null,[H(a("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=k=>t.config.auto_backup=k),onChange:e[1]||(e[1]=(...k)=>s.updateConfig&&s.updateConfig(...k))},null,544),[[ke,t.config.auto_backup]]),e[12]||(e[12]=$(" Ëá™Âä®ÂàõÂª∫Â§á‰ªΩ ",-1))]),e[13]||(e[13]=a("span",{class:"config-help"},"Â∫îÁî®Êõ¥Êñ∞ÂâçËá™Âä®ÂàõÂª∫ÂÆåÊï¥Â§á‰ªΩ",-1))])]),_:1}),t.showRollbackDialog?(f(),_("div",Dn,[a("div",Un,[e[16]||(e[16]=a("h3",null,"Á°ÆËÆ§ÂõûÊªö",-1)),e[17]||(e[17]=a("p",null,"Á°ÆËÆ§ÂõûÊªöÂà∞‰∏äÊ¨°Â§á‰ªΩÂêóÔºü",-1)),a("div",Pn,[d(c,{type:"big",onClick:s.confirmRollback,class:"danger"},{default:h(()=>[...e[14]||(e[14]=[$("Á°ÆËÆ§ÂõûÊªö",-1)])]),_:1},8,["onClick"]),d(c,{type:"big",onClick:s.cancelRollback,class:"left-button"},{default:h(()=>[...e[15]||(e[15]=[$("ÂèñÊ∂à",-1)])]),_:1},8,["onClick"])])])])):G("",!0),t.showBackupDialog?(f(),_("div",jn,[a("div",Fn,[e[21]||(e[21]=a("h3",null,"ÂàõÂª∫Â§á‰ªΩ",-1)),e[22]||(e[22]=a("p",null,"ÊòØÂê¶Âú®Â∫îÁî®ÂâçÂàõÂª∫ÂÖ®ÈáèÂ§á‰ªΩÔºü",-1)),a("div",Ln,[d(c,{type:"big",onClick:e[2]||(e[2]=k=>s.confirmUpdateWithBackup(!0)),class:"left-button"},{default:h(()=>[...e[18]||(e[18]=[$("ÊòØ",-1)])]),_:1}),d(c,{type:"big",onClick:e[3]||(e[3]=k=>s.confirmUpdateWithBackup(!1)),class:"left-button"},{default:h(()=>[...e[19]||(e[19]=[$("Âê¶",-1)])]),_:1}),d(c,{type:"big",onClick:s.cancelUpdate,class:"left-button"},{default:h(()=>[...e[20]||(e[20]=[$("ÂèñÊ∂à",-1)])]),_:1},8,["onClick"])])])])):G("",!0)]),_:1})}const Hn=F(wn,[["render",On],["__scopeId","data-v-85edb817"]]),Nn={class:"w-full h-full flex items-center justify-between relative px-5 py-2"},Gn=j({__name:"SettingsNav",emits:["remove-more-menu-from-a"],setup(n,{expose:e,emit:u}){const o=u,t=J(),s=m(null),c=m(null),p=m(null),y=m(null),k=m(null),x=m(null),M=m(null),g=m(null),r=m(null),i=m(null),b=m(null),S=m("textBtn"),T=V=>{const v={characterBtn:p,textBtn:y,backgroundBtn:k,soundBtn:x,historyBtn:M,saveBtn:g,advanceBtn:r,scheduleBtn:i,updateBtn:b}[V];v?.value?.$el&&z(v.value.$el)},z=V=>{!s.value||!V||(s.value.style.left=`${V.offsetLeft}px`,s.value.style.width=`${V.offsetWidth}px`)},D=(V,v)=>{S.value=v,t.setSettingsTab(V),s.value&&(s.value.style.transition="left 0.3s cubic-bezier(0.18, 0.89, 0.32, 1), width 0.3s cubic-bezier(0.18, 0.89, 0.32, 1)",T(v),setTimeout(()=>{s.value&&(s.value.style.transition="unset")},400))},E=()=>{if(!c.value)return;new ResizeObserver(v=>{S.value&&T(S.value)}).observe(c.value)},A=()=>{const V=t.currentSettingsTab;let v=null;switch(V){case"character":v=p.value;break;case"text":v=y.value;break;case"background":v=k.value;break;case"sound":v=x.value;break;case"history":v=M.value;break;case"save":v=g.value;break;case"advance":v=r.value;break;case"schedule":v=i.value;break;case"update":v=b.value;break}v?.$el&&z(v.$el)};Z(()=>{A(),E()}),U(()=>t.currentSettingsTab,()=>{A()});const w=()=>{t.toggleSettings(!1),S.value="textBtn"},B=()=>{const V=r.value?.$el;V&&V.classList.add("moreMenu")},Q=()=>{const V=r.value?.$el;V&&V.classList.remove("moreMenu"),o("remove-more-menu-from-a")};return e({addMoreMenu:B}),U(()=>{},()=>{},{immediate:!0}),(V,v)=>(f(),_("div",Nn,[v[18]||(v[18]=a("img",{src:Ae,alt:"Logo",class:"w-20 ml-5 hidden xl:block"},null,-1)),a("nav",{ref_key:"navContainer",ref:c,class:"relative w-full flex felx-row items-center justify-around h-full ease-in-out duration-100 xl:justify-center overflow-x-auto overflow-y-hidden"},[a("div",{ref_key:"indicator",ref:s,class:"absolute bottom-0 left-0 w-0 h-1 bg-brand rounded z-10 shadow-[0_0_10px_rgba(121,217,255,0.4)]"},null,512),d(l(R),{ref_key:"characterBtn",ref:p,type:"nav",icon:"character",onClick:v[0]||(v[0]=()=>D("character","characterBtn")),class:N({active:l(t).currentSettingsTab==="character"})},{default:h(()=>[...v[9]||(v[9]=[a("p",{class:"hidden xl:block"},"ËßíËâ≤",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"textBtn",ref:y,type:"nav",icon:"text",onClick:v[1]||(v[1]=()=>D("text","textBtn")),class:N({active:l(t).currentSettingsTab==="text"})},{default:h(()=>[...v[10]||(v[10]=[a("p",{class:"hidden xl:block"},"ÈÄöÁî®",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"backgroundBtn",ref:k,type:"nav",icon:"background",onClick:v[2]||(v[2]=()=>D("background","backgroundBtn")),class:N({active:l(t).currentSettingsTab==="background"})},{default:h(()=>[...v[11]||(v[11]=[a("p",{class:"hidden xl:block"},"ËÉåÊôØ",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"soundBtn",ref:x,type:"nav",icon:"sound",onClick:v[3]||(v[3]=()=>D("sound","soundBtn")),class:N({active:l(t).currentSettingsTab==="sound"})},{default:h(()=>[...v[12]||(v[12]=[a("p",{class:"hidden xl:block"},"Â£∞Èü≥",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"historyBtn",ref:M,type:"nav",icon:"history",onClick:v[4]||(v[4]=()=>D("history","historyBtn")),class:N({active:l(t).currentSettingsTab==="history"})},{default:h(()=>[...v[13]||(v[13]=[a("p",{class:"hidden xl:block"},"ÂØπËØùÂéÜÂè≤",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"saveBtn",ref:g,type:"nav",icon:"save",onClick:v[5]||(v[5]=()=>D("save","saveBtn")),class:N({active:l(t).currentSettingsTab==="save"})},{default:h(()=>[...v[14]||(v[14]=[a("p",{class:"hidden xl:block"},"Â≠òÊ°£",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"scheduleBtn",ref:i,type:"nav",icon:"schedule",onClick:v[6]||(v[6]=()=>D("schedule","scheduleBtn")),class:N({active:l(t).currentSettingsTab==="schedule"})},{default:h(()=>[...v[15]||(v[15]=[a("p",{class:"hidden xl:block"},"Êó•Á®ã",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"advanceBtn",ref:r,type:"nav",icon:"advance",onClick:v[7]||(v[7]=()=>{D("advance","advanceBtn"),Q()}),class:N({active:l(t).currentSettingsTab==="advance"})},{default:h(()=>[...v[16]||(v[16]=[a("p",{class:"hidden xl:block"},"È´òÁ∫ßËÆæÁΩÆ",-1)])]),_:1},8,["class"]),d(l(R),{ref_key:"updateBtn",ref:b,type:"nav",icon:"update",onClick:v[8]||(v[8]=()=>D("update","updateBtn")),class:N({active:l(t).currentSettingsTab==="update"})},{default:h(()=>[...v[17]||(v[17]=[a("p",{class:"hidden xl:block"},"Ê£ÄÊü•Êõ¥Êñ∞",-1)])]),_:1},8,["class"])],512),d(me,{icon:"close",class:"bg-transparent border-none p-1.5 rounded-full cursor-pointer flex items-center justify-center text-white transition-all duration-300 ease-in-out hover:text-accent hover:bg-white/10 hover:rotate-90",size:40,onClick:w})]))}}),Wn={class:"settings-panel"},qn={class:"h-[7vh] w-full"},Kn={class:"w-full h-[93vh] overflow-auto"},Xn=j({__name:"SettingsPanel",setup(n){const e=J(),u=m(null),o=m(null),t=m(!1),s=m(0);U(()=>e.showSettings,y=>{y?(t.value=!0,setTimeout(()=>{s.value=1},10)):(s.value=0,setTimeout(()=>{t.value=!1},100))},{immediate:!0});const c=()=>{o.value?.addMoreMenu()},p=()=>{u.value?.addMoreMenu()};return(y,k)=>(f(),_(O,null,[t.value?(f(),_("div",{key:0,class:"blur-overlay",style:te({opacity:s.value})},null,4)):G("",!0),H(a("div",Wn,[a("div",qn,[d(Gn,{ref_key:"settingsNavRef",ref:u,onRemoveMoreMenuFromA:c},null,512)]),a("div",Kn,[H(d(l(Ot),null,null,512),[[Y,l(e).currentSettingsTab==="save"]]),H(d(l(Nt),null,null,512),[[Y,l(e).currentSettingsTab==="text"]]),H(d(l(na),null,null,512),[[Y,l(e).currentSettingsTab==="sound"]]),H(d(l(Sa),{ref_key:"settingsAdvanceRef",ref:o,onRemoveMoreMenuFromB:p},null,512),[[Y,l(e).currentSettingsTab==="advance"]]),H(d(l(Wa),null,null,512),[[Y,l(e).currentSettingsTab==="history"]]),H(d(l(qa),null,null,512),[[Y,l(e).currentSettingsTab==="schedule"]]),H(d(l(pn),null,null,512),[[Y,l(e).currentSettingsTab==="character"]]),H(d(l(kn),null,null,512),[[Y,l(e).currentSettingsTab==="background"]]),H(d(l(Hn),null,null,512),[[Y,l(e).currentSettingsTab==="update"]])])],512),[[Y,l(e).showSettings]])],64))}});export{Yn as _,Xn as a};
